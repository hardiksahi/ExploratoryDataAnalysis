---
title: "Analysis of Armed Conflict"
always_allow_html: yes
output:
  html_document:
    toc: yes
  pdf_document:
    keep_tex: yes
    latex_engine: xelatex
    number_sections: yes
  word_document: default
header-includes:
- \usepackage{graphicx}
- \usepackage{epic}
- \usepackage{color}
- \usepackage{hyperref}
- \usepackage{multimedia}
- \PassOptionsToPackage{pdfmark}{hyperref}\RequirePackage{hyperref}
- \newcommand{\code}[1]{\texttt{#1}}
- \newcommand{\ve}[1]{\mathbf{#1}}
- \newcommand{\pop}[1]{\mathcal{#1}}
- \newcommand{\samp}[1]{\mathcal{#1}}
- \newcommand{\subspace}[1]{\mathcal{#1}}
- \newcommand{\sv}[1]{\boldsymbol{#1}}
- \newcommand{\sm}[1]{\boldsymbol{#1}}
- \newcommand{\tr}[1]{{#1}^{\mkern-1.5mu\mathsf{T}}}
- \newcommand{\abs}[1]{\left\lvert ~{#1} ~\right\rvert}
- \newcommand{\size}[1]{\left\lvert {#1} \right\rvert}
- \newcommand{\norm}[1]{\left|\left|{#1}\right|\right|}
- \newcommand{\field}[1]{\mathbb{#1}}
- \newcommand{\Reals}{\field{R}}
- \newcommand{\Integers}{\field{Z}}
- \newcommand{\Naturals}{\field{N}}
- \newcommand{\Complex}{\field{C}}
- \newcommand{\Rationals}{\field{Q}}
- \newcommand{\widebar}[1]{\overline{#1}}
- \newcommand{\wig}[1]{\tilde{#1}}
- \newcommand{\bigwig}[1]{\widetilde{#1}}
- \newcommand{\leftgiven}{~\left\lvert~}
- \newcommand{\given}{~\vert~}
- \newcommand{\indep}{\bot\hspace{-.6em}\bot}
- \newcommand{\notindep}{\bot\hspace{-.6em}\bot\hspace{-0.75em}/\hspace{.4em}}
- \newcommand{\depend}{\Join}
- \newcommand{\notdepend}{\Join\hspace{-0.9 em}/\hspace{.4em}}
- \newcommand{\imply}{\Longrightarrow}
- \newcommand{\notimply}{\Longrightarrow \hspace{-1.5em}/ \hspace{0.8em}}
- \newcommand*{\intersect}{\cap}
- \newcommand*{\union}{\cup}
- \DeclareMathOperator*{\argmin}{arg\,min}
- \DeclareMathOperator*{\argmax}{arg\,max}
- \DeclareMathOperator*{\Ave}{Ave\,}
- \newcommand{\permpause}{\pause}
- \newcommand{\suchthat}{~:~}
- \newcommand{\st}{~:~} 
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

```{r pathSetup}
#dataDirectory <- "/Users/hardiksahi/Second Term/Stat 847/Project/Stat847Data"
dataDirectory <- "/Users/hardiksahi/Second Term/Stat 847/Project/FinalDataSet847"
path_concat <- function(path1, path2, sep="/") paste(path1, path2, sep = sep)
```

---

```{r armedConflict}
armedConflict <- read.csv(file = path_concat(dataDirectory, "ArmedConflict.csv"))
```


# Problem statement

### Issue that we are trying to address
Cold war, that spanned from 1947 to 1991 was one of the most trying phases in the world history. The two sides of the world, the Capitalist Western bloc comprising of USA and its NATO allies and Marxist-Leninist Eastern bloc led by Soviet Union (USSR) and its satellite states were at loggerheads with each other. Aside from the development of the two sides' nuclear arsenals, and their deployment of conventional military forces, the struggle for dominance was expressed via proxy wars around the globe, psychological warfare and massive propaganda campaigns[1].

Post-cold war hopes of a world without wars, where conflicts between and within nations are peacefully resolved through negotiations, have not been fully realized. Recent data on armed conflicts indicate that during the period 1989-2016, there were 997 such conflicts in 117 countries around the world. [2].

The main purpose of the analysis conducted in the report is to have a deeper and clearer understanding of the conflict zones throughout the world, the countries involved in direct conflicts, the countries involved in proxy wars  and how has such a volatile scenario shaped the way the countries interact with each other in the present day world. This helps us understand the political and social climate in the countries that have transformed themselves from a **Fragile state** [involved in inter-state and intra-state conflicts] into a **Stable state** and those which end up becoming a **Failed state.**[3]

### Identifying Target population, ${P}_{Target}$
The population of interest about which we want to learn some attributes is called target population.

### Unit 
The basic unit of analysis in the **Uppsala Conflict Data Program-Georeferenced Event Dataset [UCDP-GED] Version 17.1** is the “event”, i.e. “An incident where armed force was used by an organised actor against another organized actor, or against civilians, resulting in at least 1 direct death at a specific location and a specific date”.[4]

The target population will also include the set the events that have **not been recorded** in the the UCDP dataset either because they were **not reported** or they were **not clear enough from the sources to have occured**.  Also, any ongoing conflicts or conflicts that might happen in future form an essential component of the target population.

### Variates in the dataset
```{r}
names(armedConflict)
```

Detailed description of the fields is present in the attached codebook. Other datasets will be explained as and when required.

# Understanding the dataset

### Source of data

Main Data sources:

1. ArmedConflict.csv
2. ExternalHelpLarge.csv

Auxillary Data sources:

1. TotalWorldPop.csv
2. CountryLatLong.csv
 
The original reporting underlying UCDP GED[4] are collected from three sets of sources:

1. **global newswire reporting**
2. **global monitoring and translation of local news performed by the BBC**
3. **secondary sources such as local media, NGO and IGO reports, field reports, books etc.**

This data collection is done via a two pass process. The first step involves consulting newswire sources from around the globe. The second step involves consulting local/ specialized sources based on the data collected from the first pass.

**Sources for first pass:**

- Reuters News, 
- Agence France Presse
- Associated Press
- Xinhua 
- BBC Monitoring

**Sources for second pass:**

- local monitoring of various local media
- local monitoring and research organizations
- global NGO reports
- UN, EU, AU and other IGO reports
- governmental publications
- research articles or books etc

The decision to whether or not the secondary source from second pass should be included is based on the conclusion reached at the end of first pass. If the infirmation gained after first pass is sufficient, then secondary source is not included.


### Adding new columns to the dataset

I have added multiple columns to the existing data.

Dataset: ArmedConflict.csv

1. code: ISO Country code
2. durationEvent: Event duration in days.
3. groupsInvolved: Groups involved in conflict.

Dataset: ExternalHelpLarge.csv

1. code1: ISO code for country on side1
2. country1_lat: Latitude of country on side1
3. country1_long: Longitude of country on side1
4. code2: ISO code for country on side2, 'NA' otherwise
5. country2_lat: Latitude of country on side2
6. country2_long: Longitude of country on side2
7. external_code: ISO code for country giving external support.
8. external_lat: Latitude of country providing external support 
9. external_long: Longitude of country providing external support 




### Data validation and reliability

Difference in reporting of various events has an impact on the level of detail to which the information can be extracted and hence included in the dataset. For example, reporting of precise location of the occurence of event might be uncommon and hence not possible to capture in the dataset at hand. 


### Assurance of quality of the dataset

Multiple steps have been taken to ensure quality of the dataset:

1. **Two stage coding** procedure which involves atleast two different coders being in charge of coding and revising the events before the final dataset is released. This is done atleast one year apart so that the two coders are not influenced by each other and hence ensure **inter-coder reliability**.

2. **Pre-defined set of protocols** to be followed by coders at all times to ensure that highest quality product is delivered.

3. Inconsistencies in the data are resolved by extensive background research combined with frequent meetings.

4. Around 50 automatic checks followed by manual checking by person in-charge is done on the dataset before it is finally made public.

5. Any change to be made to dataset involves some kind of human intervention to ensure that the edge cases are not missed or considered as outliers.


### Pattern exploration in the dataset

**1. Distribution of conflicts based on region:**
```{r}
library(plyr)
library(ggplot2)
library(stringr)
library(gtable)
library(gridExtra)
library(plotly)
library(dplyr)
```

```{r}
uniqueConflictsRow <-  armedConflict[!duplicated(armedConflict$conflict_new_id), ]

freqTableConflictRegionWise <- plyr::count(uniqueConflictsRow, "region" )
barplot_conflict_region <- plot_ly(data = freqTableConflictRegionWise, 
  x = ~region,
  y = ~freq,
  name = "RegionWiseConflict",
  type = "bar", hoverinfo = "none"
) %>% layout(xaxis = list(title = 'Regions'), yaxis = list(title ="Number of conflicts"), title = "Number of unique armed conflicts versus Region [1989-2016]",showlegend = FALSE)

barplot_conflict_region <- add_text(barplot_conflict_region,data = freqTableConflictRegionWise,  x = ~region, y = ~freq+5, text = ~freq, color = I("red"), hoverinfo = "none") 

barplot_conflict_region
```

As is evident from the above barplot, **Africa** has seen the maximum number of armed conflicts [592] in the world from 1989 to 2016. Curiously, Middle East has much lower number of armed conflicts [57] because:

1. The war against Islamic State [IS] in Syria and Iraq is not included in the dataset because it is very difficult to keep track record of the conflicts occuring in the afflicted countries.

2. The plot captures UNIQUE conflicts. In the Middle East, the same conflict has been going on and on for years together and thus, it is included only once in the above plot.


**2. Trend of the conflicts happening throughout the world:**
```{r}
freqTableConflictYearWise <- plyr::count(uniqueConflictsRow, "year")
barplot_conflict_year <- plot_ly(data = freqTableConflictYearWise, 
  x = ~year,
  y = ~freq,
  name = "YearWiseConflict",
  type = "bar", hoverinfo = "none", color = "Reds"
) %>% layout(xaxis = list(title = 'Year'), yaxis = list(title ="Number of conflicts"), title = "Unique Armed Conflicts worldwide per year [1989-2016]",showlegend = FALSE)

barplot_conflict_year <- add_text(barplot_conflict_year,data = freqTableConflictYearWise,  x = ~year, y = ~freq+5, text = ~freq, color = I("red"), hoverinfo = "none")

barplot_conflict_year

```

```{r}
freqTableConflictYearWiseDF <- as.data.frame(freqTableConflictYearWise) #Convertusing as.data.frame it to dataFrame 
ts_conflict_year <- ts(freqTableConflictYearWiseDF$freq, frequency = 1, start = c(1989), end = c(2016))
plot(ts_conflict_year, ylab = "Number of conflicts", main = "Unique Armed Conflicts per year time series [1989-2016].", col = "red")
ts_conflict_year
```


Analysis of the above graphs reveal that the year 2013 saw a jump from 54 armed conflicts to 81 unique armed conflicts. This included the all-out attack to destroy Taleban, Al-Qaeda and its affiliates spread in different countries in West Asia and Middle East. Hence many wars were waged simultaneously to rip the aforementioned terrorist organizations.


**3. Region wise trend of armed conflicts:**

```{r}
regionYearColumns <- c("region", "year")
df_regionyear_columns_ac <- armedConflict[regionYearColumns]
groupBy_region_year <- df_regionyear_columns_ac %>% group_by(region,year) %>% mutate(event_count = n())
unique_region_year_df <- unique(groupBy_region_year[,c("region","year","event_count")])

#Region1:Africa
africa_year_df <- subset(unique_region_year_df, region == 'Africa')
africa_year_df_sorted <- africa_year_df[order(africa_year_df$year),]

#Region2:Americas
americas_year_df <- subset(unique_region_year_df, region == 'Americas')
americas_year_df_sorted <- americas_year_df[order(americas_year_df$year),]

#Region3:Asia
asia_year_df <- subset(unique_region_year_df, region == 'Asia')
asia_year_df_sorted <- asia_year_df[order(asia_year_df$year),]

#Region3:Europe
europe_year_df <- subset(unique_region_year_df, region == 'Europe')
europe_year_df_sorted <- europe_year_df[order(europe_year_df$year),]

#Region3:MiddleEast
me_year_df <- subset(unique_region_year_df, region == 'Middle East')
me_year_df_sorted <- me_year_df[order(me_year_df$year),]

allregion_year_df <- data.frame(year = africa_year_df_sorted$year, africa_count = africa_year_df_sorted$event_count, america_count = americas_year_df_sorted$event_count, asia_count = asia_year_df_sorted$event_count, europe_count = europe_year_df_sorted$event_count, me_count = me_year_df_sorted$event_count)

trend_conflict_event_region <- plot_ly(data =allregion_year_df,x = ~factor(year))%>% add_trace(y=~africa_count, name = 'Africa', mode = 'lines+markers',type = 'scatter')%>% add_trace(y=~america_count, name = 'Americas', mode = 'lines+markers',type = 'scatter')%>%add_trace(y=~asia_count, name = 'Asia', mode = 'lines+markers',type = 'scatter')%>%add_trace(y=~europe_count, name = 'Europe', mode = 'lines+markers',type = 'scatter')%>%add_trace(y=~me_count, name = 'Middle East', mode = 'lines+markers',type = 'scatter') %>% layout(title = "Trend of conflicts in different regions", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of conflict events'))

trend_conflict_event_region
```



As can be clearly seen from the line plot above, there has been a general upward trend in the conflict events in Asia with a huge increase in years spanning from 2001 to 2008. This can be explained due to the highly unstable situation in the Asian country of Afghanistan. The country has been under constant attack by Taleban and Al-Qaeda forces and is notorious for providing safe haven to many other terrorist organizations.

The country of Pakistan has also been under constant terrorist attacks in the recent years with many organizations like Tehrik-e-Taliban Pakistan [TPP] providing active support to Taleban and Al-Qaeda. 

Also, hostility between the governments of India and Pakistan has been extremely high with both the sides exchanging fire on a regular basis. The situation is dire particularly in the controversial area of Jammu and Kashmir, with Kashmiri insurgents regularly attacking the civilians and army outposts.

All the above factors combined have lead to such a huge jump in the armed conflict events in Asia in the recent years.

Africa has also seen some of the deadliest conflicts in recent times with majority of the constituent states indulged in civil conflict. Such a volatile environment in which there is always a power struggle between different factions provides a breeding ground for extremist organizations to establish themselves e.g. Boko Haram in Nigeria and Salafist Group for Preaching and Combat [GSPC] in Algeria which formed basis for al-Qaeda in Islamic Maghreb [AQIM]. From 2007 onwards, Operation Juniper Shield, a joint operation conducted by USA and partner nations in the Sahara/Sahel region of Africa, consisting of counterterrorism efforts and policing of arms and drug trafficking across central Africa[5], has led to increased engagement between the governemnt forces and terrorist otfits in the African region.  


Also, as expected the region of Middle East has been in a constant state of war with many regional and international powers playing proxy wars in the afflicted areas of Syria, Iraq, Yemen, Gaza etc. The dramatic increase started in 2003 with the US invasion of Iraq [6], worsened by the start of Arab spring in 2010 in the Tunisia[7] and US invasion of Libya in 2013. 
Ever since, Middle East has not been able to arrive at a stable state.


**4. Barplot to show violenceType: State, Non-state, One sided:**
```{r}
freqTableConflictVTypeWise <- plyr::count(uniqueConflictsRow, "type_of_violence")
freqTableConflictVTypeWise$type_of_violence[freqTableConflictVTypeWise$type_of_violence == 1]<-"State"
freqTableConflictVTypeWise$type_of_violence[freqTableConflictVTypeWise$type_of_violence == 2]<-"Non State"
freqTableConflictVTypeWise$type_of_violence[freqTableConflictVTypeWise$type_of_violence == 3]<-"One sided"


barplot_conflict_vType <- plot_ly(data = freqTableConflictVTypeWise, 
  x = ~factor(type_of_violence),
  y = ~freq,
  name = "ViolenceTypeConflict",
  type = "bar", hoverinfo = "none", color = "Reds"
) %>% layout(xaxis = list(title = 'Conflict type'), yaxis = list(title ="Number of conflicts"), title = "Type of Violence [1989-2016].",showlegend = FALSE)

barplot_conflict_vType <- add_text(barplot_conflict_vType,data = freqTableConflictVTypeWise,  x = ~type_of_violence, y = ~freq+5, text = ~freq, color = I("red"), hoverinfo = "none")

barplot_conflict_vType
```

As is evident from the above barplot, the non state conflict is the maximum [576] as most of the countries are fighting within its borders either owing to a civil war or fight against terrorist establishments within its boundaries. The armed conflicts in which two different countries [State based] come at loggerheads with each other is pretty small[169 conflicts].
We need to remember an important scenario in which the countries don't fight against each other directly but are indulged in proxy wars in already war-torn countries in the world e.g. Syria, Iraq, Yemen etc. Hence such engagements are included in Non state conflicts instead of state conflicts.


**5. Trend of different violence types over the years [1989-2016]:**

```{r}
regionYearTypeColumns <- c("region", "year","type_of_violence")
df_regionyeartype_columns_ac <- armedConflict[regionYearTypeColumns]
groupBy_region_year_type <- df_regionyeartype_columns_ac %>% group_by(region,year,type_of_violence) %>% mutate(event_count = n())
unique_region_year_type_df <- unique(groupBy_region_year_type[,c("region","year","type_of_violence","event_count")])

getViolenceTypeSubset <- function(df, violenceType){
  return(subset(df, type_of_violence == violenceType))
}
```

**Region: Africa**
```{r}
#Region1:Africa
africa_year_type_df <- subset(unique_region_year_type_df, region == 'Africa')
africa_year_type_df_sorted <- africa_year_type_df[order(africa_year_type_df$year),]
africa_state_df <- getViolenceTypeSubset(africa_year_type_df_sorted,1)
africa_nonstate_df <- getViolenceTypeSubset(africa_year_type_df_sorted,2)
africa_oneside_df <- getViolenceTypeSubset(africa_year_type_df_sorted,3)

africa_cum_df <- data.frame(year= africa_state_df$year, state_count = africa_state_df$event_count, non_state_count = africa_nonstate_df$event_count, oneside_count = africa_oneside_df$event_count)


trend_conflict_event_africa_type <- plot_ly(data =africa_cum_df,x = ~factor(year))%>% add_trace(y=~state_count, name = 'State based', mode = 'lines+markers',type = 'scatter')%>% add_trace(y=~non_state_count, name = 'Non state based', mode = 'lines+markers',type = 'scatter')%>%add_trace(y=~oneside_count, name = 'One sided', mode = 'lines+markers',type = 'scatter') %>% layout(title = "Trend of different types of conflicts in Africa", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of conflict events'))
trend_conflict_event_africa_type

```



**Analysis for Africa:**

- **State based** armed conflict has increased over the recent years, particularly 2007 onwards. Such an upward trend can be attributed to **increased attacks of terrorist outfits** against the government forces. e.g. Frequent clashes between Government of Algeria and GSPC & IS, Government of Uganda and Lord's Resistance Army[LRA], Government of Rwanda and Democratic Forces for the Liberation of Rwanda [FDLR] and so on. Next it can be attributed to **territorial conflicts** owing to historical reasons amongst many other. For example, Conflits between governments of Sudan and South Sudan, between governements of Ethiopia and Eritrea. Owing to the current volatile situation in African countries, it is highly unlikely that the situation will improve.

- **Non-state** armed conflict involves non government entities at loggerheads with each other. This can primarily be due to access for **territory**, grazing land, exerting formal/ informal authority, access to **lootable resources** like livestock and most importantly **ethnicity and religion**. We observe significant increase in such conflicts in 1992 owing largely to frequent clashes between Supporters of African National Congress and Inkatha Freedom Party and 2014 due to clashes based on religion (Muslims and Christians).

- **One sided** armed conflicts occur when the civilians are specifically targeted. Some of the several reasons for this might be to **coerce the civilians** into submission and hence have the support of the local population, weak groups can be more prone to targeting civilians as it might be one of the ways the group **secures the resources** that it needs to function effectively and lastly because of **ethno-religious** divides [8]. In the plot, we see a spike in the year 1994 which can be majorly attributed to the Hutu-Tutsi clashes in Rwanda, attacks by  Armed Islamic Group (GIA) in Algeria, National Union for the Total Independence of Angola (UNITA) in Angola and so on. Also, the spike in year 2015 can be attributed to attacks by terrorist outfits like IS, LRA and others.


**Region: Asia**

```{r}
asia_year_type_df <- subset(unique_region_year_type_df, region == 'Asia')
asia_year_type_df_sorted <- asia_year_type_df[order(asia_year_type_df$year),]
asia_state_df <- getViolenceTypeSubset(asia_year_type_df_sorted,1)
asia_nonstate_df <- getViolenceTypeSubset(asia_year_type_df_sorted,2)
asia_oneside_df <- getViolenceTypeSubset(asia_year_type_df_sorted,3)

asia_cum_df <- data.frame(year= asia_state_df$year, state_count = asia_state_df$event_count, non_state_count = asia_nonstate_df$event_count, oneside_count = asia_oneside_df$event_count)

trend_conflict_event_asia_type <- plot_ly(data =asia_cum_df,x = ~factor(year))%>% add_trace(y=~state_count, name = 'State based', mode = 'lines+markers',type = 'scatter')%>% add_trace(y=~non_state_count, name = 'Non state based', mode = 'lines+markers',type = 'scatter')%>%add_trace(y=~oneside_count, name = 'One sided', mode = 'lines+markers',type = 'scatter') %>% layout(title = "Trend of different types of conflicts in asia", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of conflict events'))

trend_conflict_event_asia_type

```



**Analysis for Asia:**

- **State based:** Throughout the years under study, state based violence has invariably increased in Asia with huge spikes seen in 2001 and onwards. This can be attributed to the ever so increasing activities of the terrorist outfits in countries like Afghanistan and Pakistan and as a result increased military intervention by home and western governments.

- **One sided:** An increase is observed in years from 1999 to 2008 which coincides with the peak of Taliban rule in Afghanistan and hence frequent attacks against civilians. Also, it coincides with the peak of Kashmir insurgency in India and hence increased attack on civilians. 



**Region: Americas**

```{r}
americas_year_type_df <- subset(unique_region_year_type_df, region == 'Americas')
americas_year_type_df_sorted <- americas_year_type_df[order(americas_year_type_df$year),]
americas_state_df <- getViolenceTypeSubset(americas_year_type_df_sorted,1)
americas_nonstate_df <- getViolenceTypeSubset(americas_year_type_df_sorted,2)
americas_oneside_df <- getViolenceTypeSubset(americas_year_type_df_sorted,3)

americas_cum_df <- data.frame(year= americas_state_df$year, state_count = americas_state_df$event_count, non_state_count = americas_nonstate_df$event_count, oneside_count = americas_oneside_df$event_count)


trend_conflict_event_americas_type <- plot_ly(data =americas_cum_df,x = ~factor(year))%>% add_trace(y=~state_count, name = 'State based', mode = 'lines+markers',type = 'scatter')%>% add_trace(y=~non_state_count, name = 'Non state based', mode = 'lines+markers',type = 'scatter')%>%add_trace(y=~oneside_count, name = 'One sided', mode = 'lines+markers',type = 'scatter') %>% layout(title = "Trend of different types of conflicts in americas", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of conflict events'))

trend_conflict_event_americas_type
```


**Analysis for Americas:**

- **State based** armed conflict saw a spike in 2004 owing to fights between Government of Colombia and Marxist rebel groups like National Liberation Army (ELN) and Revolutionary Armed Forces of Colombia (FARC) which subsequently subsided.

- Interestingly **Non state based** armed conflicts in Americas can attributed to armed conflicts between various drug cartels operating in Latin America especially Juarez and Sinaloa cartel. Clearly the trend has been on a rise as more and more cartels are getting involved in bloody conflicts to earn more authority in the contested areas.


**Region: Europe**

```{r}
europe_year_type_df <- subset(unique_region_year_type_df, region == 'Europe')
europe_year_type_df_sorted <- europe_year_type_df[order(europe_year_type_df$year),]
europe_state_df <- getViolenceTypeSubset(europe_year_type_df_sorted,1)
europe_nonstate_df <- getViolenceTypeSubset(europe_year_type_df_sorted,2)
europe_oneside_df <- getViolenceTypeSubset(europe_year_type_df_sorted,3)

europe_cum_df <- data.frame(year= europe_state_df$year, state_count = europe_state_df$event_count, oneside_count = europe_oneside_df$event_count) #, non_state_count = europe_nonstate_df$event_count, 


trend_conflict_event_europe_type <- plot_ly(data =europe_cum_df,x = ~factor(year))%>% add_trace(y=~state_count, name = 'State based', mode = 'lines+markers',type = 'scatter')%>%add_trace(y=~oneside_count, name = 'One sided', mode = 'lines+markers',type = 'scatter') %>%add_trace(data = europe_nonstate_df, y = ~event_count, type = 'scatter',mode = 'lines+markers', name = "Non state")%>% layout(title = "Trend of different types of conflicts in europe", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of conflict events'))

trend_conflict_event_europe_type
```


**Analysis for Europe**

It is important to keep into consideration that Russia is included as a part of Europe in the dataset. Keeping that in mind, the peak in **state based** conflict in 1992-1993 can be attributed to the post Cold war breakup of USSR which resulted in multiple newly independent states fighting amongst each other for territory and ethnic reasons. For example Bosnian War, Mondova versus PMR etc .

**Non state conflicts** have been pretty much non existent in Europe.


**Region: Middle East**

```{r}
me_year_type_df <- subset(unique_region_year_type_df, region == 'Middle East')
#me_year_2009_ns <- data.frame(region = 'Middle East', year = factor(2009),type_of_violence = 2,event_count =1)

#me_year_type_df <- rbind(me_year_type_df,me_year_2009_ns)
me_year_type_df_sorted <- me_year_type_df[order(me_year_type_df$year),]
me_state_df <- getViolenceTypeSubset(me_year_type_df_sorted,1)
me_nonstate_df <- getViolenceTypeSubset(me_year_type_df_sorted,2)
me_oneside_df <- getViolenceTypeSubset(me_year_type_df_sorted,3)

#, non_state_count = me_nonstate_df$event_count
me_cum_df <- data.frame(year= me_state_df$year, state_count = me_state_df$event_count, oneside_count = me_oneside_df$event_count) #, non_state_count = me_nonstate_df$event_count

#%>% add_trace(y=~non_state_count, name = 'Non state based', mode = 'lines+markers',type = 'scatter')
trend_conflict_event_me_type <- plot_ly(data =me_cum_df,x = ~factor(year))%>% add_trace(y=~state_count, name = 'State based', mode = 'lines+markers',type = 'scatter')%>%add_trace(y=~oneside_count, name = 'One sided', mode = 'lines+markers',type = 'scatter') %>% layout(title = "Trend of different types of conflicts in Middle East", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of conflict events'))

trend_conflict_event_me_type
```

**Analyis for Middle East:**

As can be seen from the line plot above, **state based conflict** is on rise in the middle east. We see a sharp increase in 2003 which is attributed to all the events that are associated with US invasion of Iraq. In the recent years from 2010 onwards, we see a sharp increase in the number of conflicts associated with the events revolving around the Arab Spring in 2010. This power gap has lead to sprouting of many terrorist organizations in the region. e.g. ISIL etc.


```{r}
# trend_conflict_event_me_ns_type <- plot_ly(data =me_nonstate_df,x = ~year,y=~event_count, name = 'Non state based', mode = 'lines+markers',type = 'scatter') %>% layout(title = "Trend of non state conflicts in Middle East", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of conflict events'))
# 
# trend_conflict_event_me_ns_type
```


**6. Different countries involved in conflicts region wise [1989-2016]:**

Region: Asia

```{r}
uniqueConflictsRowAsia <- subset(uniqueConflictsRow, region == 'Asia')#[,c("country", "type_of_violence")]
freqTableConflictAsia <- plyr::count(uniqueConflictsRowAsia, vars = c("country", "type_of_violence"))
ggplot_asia <-ggplot(data = freqTableConflictAsia, aes(x = country, y = freq, fill = factor(type_of_violence)))+ theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold"))
ggplot_asia <- ggplot_asia+ geom_bar(stat = "identity", position = "dodge") +labs(fill = "Violence Type") + scale_fill_discrete(labels=c("State", "Non-state", "One-side")) + ggtitle("Country-wise distribution of conflicts based on ViolenceType(Asia) [1989-2016]") + xlab("Country") + ylab("Frequency of Conflicts")+coord_flip()
ggplot_asia
```


From the above barplot, it can be seen that Afghanistan, Pakistan and India are some of the worst affected countries by armed conflicts in Asia region.

**Region: Africa**

```{r}
uniqueConflictsRowAfrica <- subset(uniqueConflictsRow, region == 'Africa')#[,c("country", "type_of_violence")]
freqTableConflictAfrica <- plyr::count(uniqueConflictsRowAfrica, vars = c("country", "type_of_violence"))
ggplot_africa <-ggplot(data = freqTableConflictAfrica, aes(x = country, y = freq, fill = factor(type_of_violence)))+ theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold"))
ggplot_africa <-ggplot_africa+ geom_bar(stat = "identity", position = "dodge") +labs(fill = "Violence Type") + scale_fill_discrete(labels=c("State", "Non-state", "One-side")) + ggtitle("Country-wise dist of conflicts based on ViolenceType (Africa) [1989-2016]") + xlab("Country") + ylab("Frequency of Conflicts")+coord_flip()
ggplot_africa
```

From the above stacked barplot, it can be seen that Nigeria, Somalia, Sudan and Uganda are some of the worst affected countries in the African region with extremely high frequency of **Non state conflict**. This can be attributed to frequent clashes between non government factions fighting to assert authority over the other.


**Region: Europe**

```{r}
uniqueConflictsRowEurope <- subset(uniqueConflictsRow, region == 'Europe')#[,c("country", "type_of_violence")]
freqTableConflictEurope <- plyr::count(uniqueConflictsRowEurope, vars = c("country", "type_of_violence"))
ggplot_europe <-ggplot(data = freqTableConflictEurope, aes(x = country, y = freq, fill = factor(type_of_violence)))+ theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold"))
ggplot_europe <-ggplot_europe+ geom_bar(stat = "identity", position = "dodge") +labs(fill = "Violence Type") + scale_fill_discrete(labels=c("State", "Non-state", "One-side")) + ggtitle("Country-wise dist of conflicts based on ViolenceType (Europe) [1989-2016]") + xlab("Country") + ylab("Frequency of Conflicts")+coord_flip()
ggplot_europe
```

Clearly from the above barplot, we can see majority of the armed conflicts have taken place in the constituent countries of erstwhile USSR e.g. Ukraine, Yugoslavia, Georgia etc. 


**Region: Americas**

```{r}
uniqueConflictsRowAmericas <- subset(uniqueConflictsRow, region == 'Americas')#[,c("country", "type_of_violence")]
freqTableConflictAmericas <- plyr::count(uniqueConflictsRowAmericas, vars = c("country", "type_of_violence"))
ggplot_americas <-ggplot(data = freqTableConflictAmericas, aes(x = country, y = freq, fill = factor(type_of_violence)))+ theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold"))
ggplot_americas <- ggplot_americas+ geom_bar(stat = "identity", position = "dodge") +labs(fill = "Violence Type") + scale_fill_discrete(labels=c("State", "Non-state", "One-side")) + ggtitle("Country-wise dist of conflicts based on ViolenceType (Americas) [1989-2016]") + xlab("Country") + ylab("Frequency of Conflicts")+coord_flip()
ggplot_americas
```

Clearly, Mexico has disproportionately high frequency of **Non state conflicts** in the Americas. This is due to the thriving drug trade in the area. Different drug cartels are at loggerheads with each other and hence we see such a high number of armed conflicts in this category. Some of the most notorious cartels are: Sinaloa cartel and Gulf cartel.


**Region: Middle East**

```{r}
uniqueConflictsRowME <- subset(uniqueConflictsRow, region == 'Middle East')#[,c("country", "type_of_violence")]
freqTableConflictME <- plyr::count(uniqueConflictsRowME, vars = c("country", "type_of_violence"))
ggplot_me <-ggplot(data = freqTableConflictME, aes(x = country, y = freq, fill = factor(type_of_violence)))+ theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold"))
ggplot_me <-ggplot_me+ geom_bar(stat = "identity", position = "dodge") +labs(fill = "Violence Type") + scale_fill_discrete(labels=c("State", "Non-state", "One-side")) + ggtitle("Country-wise dist of conflicts based on ViolenceType [1989-2016]") + xlab("Country") + ylab("Frequency of Conflicts")+coord_flip()
ggplot_me
```

As it is clear in the above plot, Iraq, Lebanon, Yemen are amongst the worst affected by armed conflicts in the middle eastern region.


Now, we have an overall idea of distributon of conflicts in different regions. The main focus of the next section will be on the impact of Non Government actors on the armed conflicts that the country experiences. This is particularly useful to analyze the situations where:

1. Non state actors are increasingly controlling access to territory and targeting civilian populations. 

2. Alongside State actors being the duty-bearers on human rights obligations, non-State entities also bear human right obligations, hence their study is extremely important to understand violation of human rights.[9]. 

3. What makes Violent Non State Actors[VNSA] different from Cold-War era is the complete disappearance of  “patron – proxy” relationships with the states. Now, VNSA have become independent actors in global politico-military settings. [10]

4. VNSA are increasingly taking control over non-governed territories of the world (failed states, lawless areas etc) [10]

For the purpose of this report, we got the non government actors in conflicts by excluding those actors that have the word "Government" in them.


**7. Distribution of non state actors in various regions of the world [1989-2016]:**

**Region: Asia**

```{r}

calculateNonGovtNonCivSubset <- function(uniqueConflictsRegion, side){
  govtPattern<- "Government"
  if(side == 'a'){
    return(subset(uniqueConflictsRegion, !str_detect(side_a, govtPattern)))
  }
  else if(side == 'b'){
    return(subset(uniqueConflictsRegion, type_of_violence != 3 & !str_detect(side_b, govtPattern)))
  }
}

nonGovtConflictAsiaA = calculateNonGovtNonCivSubset(uniqueConflictsRowAsia, "a")
nonGovtConflictAsiaB = calculateNonGovtNonCivSubset(uniqueConflictsRowAsia, "b")
uniqueCombCountryOrgAsiaA <- unique(nonGovtConflictAsiaA[c("country", "side_a")])
uniqueCombCountryOrgAsiaB <- unique(nonGovtConflictAsiaB[c("country", "side_b")])
colnames(uniqueCombCountryOrgAsiaA) <- c("country", "org")
colnames(uniqueCombCountryOrgAsiaB) <- c("country", "org")
mergedDSAsia <- merge(uniqueCombCountryOrgAsiaA,uniqueCombCountryOrgAsiaB, by = c("country", "org"), all = TRUE )
countOrgCountryAsia <- plyr::count(mergedDSAsia, vars = c("country"))
ggplot_org_asia <- ggplot(mergedDSAsia) +theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold")) + geom_bar(mapping = aes(x = factor(country),fill = ..count..)) +
      labs(x = "Country", title ="Country-wise dist of Non-Govt actors[Asia]")+ scale_fill_gradient(low="blue", high="red") + coord_flip()

ggplot_org_asia
    
```

Clearly, India, Pakistan and Afghanistan have some of the highest count of non-government actors participating in armed conflicts.

Now let's analyze the number of armed conflicts associated with such actors in Asia.

```{r}
getHoverTextCountry <- function(conflictC, orgC, country){
  strToReturn = paste("Country:", country,"<br>Non Govt actors:", orgC, "<br>Conflict count:", conflictC)
  return (strToReturn)
}

getNonGovConflictCount = function(sideA, sideB){
  nonGovConflictCountA <- plyr::count(sideA, "country")
  nonGovConflictCountB <- plyr::count(sideB, "country")
  nonGovConflictCountMerged <- merge(nonGovConflictCountA, nonGovConflictCountB, by = c("country"), all = TRUE)
  nonGovConflictCountMerged$freq.x[is.na(nonGovConflictCountMerged$freq.x)]<-0
  nonGovConflictCountMerged$freq.y[is.na(nonGovConflictCountMerged$freq.y)]<-0
  nonGovConflictCountTotal <- data.frame(country = nonGovConflictCountMerged$country, confCount = nonGovConflictCountMerged$freq.x + nonGovConflictCountMerged$freq.y)
  return(nonGovConflictCountTotal)
}

nonGovConflictCountAsiaTotal <- getNonGovConflictCount(nonGovtConflictAsiaA, nonGovtConflictAsiaB)
dfCountryConfOrgAsia <- data.frame(country = nonGovConflictCountAsiaTotal$country, confCount = nonGovConflictCountAsiaTotal$confCount, orgCount = countOrgCountryAsia$freq)

ggplot_org_conflict_asia <- plot_ly(dfCountryConfOrgAsia, x = ~confCount, y = ~orgCount,color = ~country, size = ~confCount, alpha = 0.5, text = ~getHoverTextCountry(confCount,orgCount,country), hoverinfo = "text", colors = "Dark2") %>% layout(title = 'Number of Non-Govt actors involved in conflict[Asia]',yaxis = list(title = "Non Gov actors count"),xaxis = list(title = "Conflict count"), showlegend = FALSE)

ggplot_org_conflict_asia
```

Clearly, from the scatterplot above, there exists a postive correlation between conflict count and the number of non state actors working in a country.


**Region: Africa**

```{r}
nonGovtConflictAfricaA = calculateNonGovtNonCivSubset(uniqueConflictsRowAfrica, "a")
nonGovtConflictAfricaB = calculateNonGovtNonCivSubset(uniqueConflictsRowAfrica, "b")
uniqueCombCountryOrgAfricaA <- unique(nonGovtConflictAfricaA[c("country", "side_a")])
uniqueCombCountryOrgAfricaB <- unique(nonGovtConflictAfricaB[c("country", "side_b")])
colnames(uniqueCombCountryOrgAfricaA) <- c("country", "org")
colnames(uniqueCombCountryOrgAfricaB) <- c("country", "org")
mergedDSAfrica <- merge(uniqueCombCountryOrgAfricaA,uniqueCombCountryOrgAfricaB, by = c("country", "org"), all = TRUE )
countOrgCountryAfrica <- plyr::count(mergedDSAfrica, vars = c("country"))
ggplot_org_africa<- ggplot(mergedDSAfrica) +theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold")) + geom_bar(mapping = aes(x = factor(country),fill = ..count..)) +labs(x = "Country", title ="Country-wise dist of Non-Govt actors[Africa]")+ scale_fill_gradient(low="blue", high="red") + coord_flip()

ggplot_org_africa
```

Clearly Nigeria, Somalia, Sudan and Democratic Republic of Congo are amongst the worst  impacted by non government actors.

Now let's analyze the number of armed conflicts associated with such actors in Africa.

```{r}
nonGovConflictCountAfricaTotal <- getNonGovConflictCount(nonGovtConflictAfricaA, nonGovtConflictAfricaB)
dfCountryConfOrgAfrica <- data.frame(country = nonGovConflictCountAfricaTotal$country, confCount = nonGovConflictCountAfricaTotal$confCount, orgCount = countOrgCountryAfrica$freq)


ggplot_org_conflict_africa <- plot_ly(dfCountryConfOrgAfrica, x = ~confCount, y = ~orgCount,color = ~country, size = ~confCount, alpha = 0.5, text = ~getHoverTextCountry(confCount,orgCount,country), hoverinfo = "text", colors = "Dark2") %>% layout(title = 'Number of Non-Govt actors involved in conflict[Africa]',yaxis = list(title = "Non Gov actors count"),xaxis = list(title = "Conflict count"), showlegend = FALSE)

ggplot_org_conflict_africa
```


**Region: Americas**

```{r}
nonGovtConflictAmericaA = calculateNonGovtNonCivSubset(uniqueConflictsRowAmericas, "a")
nonGovtConflictAmericaB = calculateNonGovtNonCivSubset(uniqueConflictsRowAmericas, "b")
uniqueCombCountryOrgAmericaA <- unique(nonGovtConflictAmericaA[c("country", "side_a")])
uniqueCombCountryOrgAmericaB <- unique(nonGovtConflictAmericaB[c("country", "side_b")])
colnames(uniqueCombCountryOrgAmericaA) <- c("country", "org")
colnames(uniqueCombCountryOrgAmericaB) <- c("country", "org")
mergedDSAmerica <- merge(uniqueCombCountryOrgAmericaA,uniqueCombCountryOrgAmericaB, by = c("country", "org"), all = TRUE )
countOrgCountryAmerica <- plyr::count(mergedDSAmerica, vars = c("country"))
ggplot_org_america <- ggplot(mergedDSAmerica) +theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold")) + geom_bar(mapping = aes(x = factor(country),fill = ..count..)) +labs(x = "Country", title ="Country-wise dist of Non-Govt org.[America]")+ scale_fill_gradient(low="blue", high="red") + coord_flip()
ggplot_org_america

```

Mexico has the highest number of non gvernement actors involved in armed conflicts in the Americas. This is due to the large number of drug cartels functioning in Mexico.


Now let's analyze the number of armed conflicts associated with such actors in Americas:

```{r}
nonGovConflictCountAmericaTotal <- getNonGovConflictCount(nonGovtConflictAmericaA, nonGovtConflictAmericaB)
dfCountryConfOrgAmerica <- data.frame(country = nonGovConflictCountAmericaTotal$country, confCount = nonGovConflictCountAmericaTotal$confCount, orgCount = countOrgCountryAmerica$freq)

ggplot_org_conflict_america <- plot_ly(dfCountryConfOrgAmerica, x = ~confCount, y = ~orgCount,color = ~country, size = ~confCount, alpha = 0.5, text = ~getHoverTextCountry(confCount,orgCount,country), hoverinfo = "text", colors = "Dark2") %>% layout(title = 'Number of Non-Govt actors involved in conflict[America]',yaxis = list(title = "Non Gov actors count"),xaxis = list(title = "Conflict count"), showlegend = FALSE)

ggplot_org_conflict_america
```


**Region: Europe**

```{r}
nonGovtConflictEuropeA = calculateNonGovtNonCivSubset(uniqueConflictsRowEurope, "a")
nonGovtConflictEuropeB = calculateNonGovtNonCivSubset(uniqueConflictsRowEurope, "b")
uniqueCombCountryOrgEuropeA <- unique(nonGovtConflictEuropeA[c("country", "side_a")])
uniqueCombCountryOrgEuropeB <- unique(nonGovtConflictEuropeB[c("country", "side_b")])
colnames(uniqueCombCountryOrgEuropeA) <- c("country", "org")
colnames(uniqueCombCountryOrgEuropeB) <- c("country", "org")
mergedDSEurope <- merge(uniqueCombCountryOrgEuropeA,uniqueCombCountryOrgEuropeB, by = c("country", "org"), all = TRUE )
countOrgCountryEurope <- plyr::count(mergedDSEurope, vars = c("country"))
ggplot_org_europe <- ggplot(mergedDSEurope) +theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold")) + geom_bar(mapping = aes(x = factor(country),fill = ..count..)) +labs(x = "Country", title ="Country-wise dist of Non-Govt org.[Europe]")+ scale_fill_gradient(low="blue", high="red") + coord_flip()
ggplot_org_europe

```

Russia (Soviet Union) has the hihest number of non state actors involved in armed conflicts in Europe.

Now let's analyze the number of armed conflicts associated with such actors in Europe:

```{r}
nonGovConflictCountEuropeTotal <- getNonGovConflictCount(nonGovtConflictEuropeA, nonGovtConflictEuropeB)
dfCountryConfOrgEurope <- data.frame(country = nonGovConflictCountEuropeTotal$country, confCount = nonGovConflictCountEuropeTotal$confCount, orgCount = countOrgCountryEurope$freq)

ggplot_org_conflict_europe <- plot_ly(dfCountryConfOrgEurope, x = ~confCount, y = ~orgCount,color = ~country, size = ~confCount, alpha = 0.5, text = ~getHoverTextCountry(confCount,orgCount,country), hoverinfo = "text", colors = "Dark2") %>% layout(title = 'Number of Non-Govt actors involved in conflict[Europe]',yaxis = list(title = "Non Gov actors count"),xaxis = list(title = "Conflict count"), showlegend = FALSE)

ggplot_org_conflict_europe    
```


**Region: Middle East**

```{r}
nonGovtConflictMEA = calculateNonGovtNonCivSubset(uniqueConflictsRowME, "a")
nonGovtConflictMEB = calculateNonGovtNonCivSubset(uniqueConflictsRowME, "b")
uniqueCombCountryOrgMEA <- unique(nonGovtConflictMEA[c("country", "side_a")])
uniqueCombCountryOrgMEB <- unique(nonGovtConflictMEB[c("country", "side_b")])
colnames(uniqueCombCountryOrgMEA) <- c("country", "org")
colnames(uniqueCombCountryOrgMEB) <- c("country", "org")
mergedDSME <- merge(uniqueCombCountryOrgMEA,uniqueCombCountryOrgMEB, by = c("country", "org"), all = TRUE )
countOrgCountryME <- plyr::count(mergedDSME, vars = c("country"))
ggplot_org_me <- ggplot(mergedDSME) +theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold")) + geom_bar(mapping = aes(x = factor(country),fill = ..count..)) + labs(x = "Country", title ="Country-wise dist of Non-Govt org.[Middle East]")+ scale_fill_gradient(low="blue", high="red") + coord_flip()

ggplot_org_me
```


Yemen, Lebanon and Iraq have the highest number of non state actors.

Now let's analyze the number of armed conflicts associated with such actors in Middle East:

```{r}
nonGovConflictCountMETotal <- getNonGovConflictCount(nonGovtConflictMEA, nonGovtConflictMEB)
dfCountryConfOrgME <- data.frame(country = nonGovConflictCountMETotal$country, confCount = nonGovConflictCountMETotal$confCount, orgCount = countOrgCountryME$freq)

ggplot_org_conflict_ME <- plot_ly(dfCountryConfOrgME, x = ~confCount, y = ~orgCount,color = ~country, size = ~confCount, alpha = 0.5, text = ~getHoverTextCountry(confCount,orgCount,country), hoverinfo = "text", colors = "Dark2") %>% layout(title = 'Number of Non-Govt actors involved in conflict[Middle East]',yaxis = list(title = "Non Gov actors count"),xaxis = list(title = "Conflict count"), showlegend = FALSE)

ggplot_org_conflict_ME
```


**8. In-detail analysis of events making up conflicts in different regions. [1989-2016]:**

Till now the analysis was done at conflict level. Now we will channel our analysis on study of individual events that make up the conflicts in different regions of the world. We will also try and find out interesting cases of conflicts worldwide and drill down deep further for analysis.

For each region, we will break down the conflicts into civilian [type_of_violence = 3] and non-civilian conflicts [type_of_violence != 3].


```{r}
getRegionWiseDurDeathDataset <- function(eventsDF, regionD){
  return(subset(eventsDF, region == regionD))
}

getPlotlyGraph = function(df,region, isCiv){
  if(isCiv){
    titleString = paste('Civilian:Duration of Conflict versus Total number of deaths [',region,'(1989-2016)]')
  }
  else{
    titleString = paste('NonCivilian:Duration of Conflict versus Total number of deaths [',region,'(1989-2016)]')
  }
  objToReturn = plot_ly(df, x = ~best, y = ~years_conflict_country, type = 'scatter',mode = 'markers',color = ~country, colors = "Set1",text = ~getLabelToPaste(country, conflict_new_id,conflict_name,deaths_civilians, deaths_unknown, best, years_conflict_country, event_count_conflict_country), hoverinfo="text") %>% layout(title = titleString, xaxis = list(title = 'Total number of deaths'), yaxis = list(title = 'Duration of conflict(years)'))
  
  return(objToReturn)
}

getLabelToPaste = function(country, conflictId, conflictName, civDeaths, unkDeaths, bestEstDeaths,yearsCountry,eventCountCountry ){
  strToReturn = paste('Country:', country, '<br>Conflict Id & Name:',conflictId,',' ,conflictName,'<br>Civilians:',civDeaths,'deaths','<br>Unknown:',unkDeaths,'deaths', '<br>Total Deaths:',bestEstDeaths,'deaths','<br> Total years in country:',yearsCountry,'years','<br> Total armedEvents in country:', eventCountCountry)
  return(strToReturn)
}

conflictDurationDeath <- c("country", "region", "conflict_name","conflict_new_id", "dyad_name","side_a","side_b","durationEvent","deaths_a","deaths_b", "deaths_civilians","deaths_unknown","best", "type_of_violence","year") 
conflictDurationDeathDF <- armedConflict[conflictDurationDeath]

##Civ and Non Civ conflicts
conflictDurationDeathNonCiv <- conflictDurationDeathDF[conflictDurationDeathDF$type_of_violence != 3,]
conflictDurationDeathNonCiv <- subset(conflictDurationDeathNonCiv, select = -c(type_of_violence) )

conflictDurationDeathCiv <- conflictDurationDeathDF[conflictDurationDeathDF$type_of_violence == 3,]
conflictDurationDeathCiv <- subset(conflictDurationDeathCiv, select = -c(type_of_violence) )

updateNonCivDF <- conflictDurationDeathNonCiv %>% group_by(country, region,conflict_new_id,conflict_name)%>%mutate(years_conflict_country = n_distinct(year), event_count_conflict_country = n())

aggregateDurationDeathConflictNonCiv <- aggregate(cbind(deaths_civilians, deaths_unknown, best) ~ country+region+conflict_new_id+conflict_name+years_conflict_country+event_count_conflict_country, updateNonCivDF, FUN = sum)


updateCivDF <- conflictDurationDeathCiv %>% group_by(country, region,conflict_new_id,conflict_name)%>%mutate(years_conflict_country = n_distinct(year), event_count_conflict_country = n())

aggregateDurationDeathConflictCiv <- aggregate(cbind(deaths_civilians, deaths_unknown, best) ~ country+region+conflict_new_id+conflict_name+years_conflict_country+event_count_conflict_country, updateCivDF, FUN = sum)
```


**Region: Asia**

**1. Attacks not focused on civilians.**

```{r}
eventDurDeathNonCivAsia <- getRegionWiseDurDeathDataset(aggregateDurationDeathConflictNonCiv, 'Asia') 
dur_death_non_civ_asia <- getPlotlyGraph(eventDurDeathNonCivAsia,'Asia',FALSE)

dur_death_non_civ_asia
```

It is expected that the longest running conflicts will also correspond to maximum number of casualities on both sides of the conflicting groups along with civilian deaths as collateral damage.

Clearly, the conflict in Afghanistan has been running for 28 years. It has the maximum number of casualities [161413] associated with it. It has resulted in 12539 non combatant casualties. Sadly, the war in Afghanistan is not yet over and the country is in the constant state of turmoil. Hence we can expect the deaths to increase in near future.

On the other hand, Kashmir insurgency in India has been running for 28 years [from the start year of dataset]. But the number of casualities [17345] is far less than that in Afghanistan. Also, there are far less reported non-combatant casualities [794].

This encourages us to understand the political and military climate in the two countries that has resulted in such a huge difference in loss of life and property. The country of Afghanistan has been under attack ever since the Saur revolution of 1978. Soviet invasion of Afghanistan in 1979 continued till 1989. This led to the spawning anti-communist outfits or Mujahideen in various parts of Afghanistan. This led to the creation of one of the most notorious extremist organizations - Taleban which ultimately took control over the country from 1992-2001. In 2001, USA and its NATO allies invaded Afghanistan to eliminate al-Qaeda and Taliban. Hence the country has always been under attack.

On the other hand, the Kashmir insurgency in India is limited to the Kashmir region of India and does not engulf the entire country. Hence we can see the huge difference in the 2 countries under consideration. This can be shown by the following scatterplots and maps:

```{r}
getEventsWithConflictId <- function(aC, conflictId){
  return(subset(aC, aC$conflict_new_id == conflictId))
}

getConflictSpecificLabel <- function(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates){
  
  strToReturn <- paste('Country:', country, '<br>Location:',where_coordinates,'<br>Start Date:',date_start,'<br> End Date:', date_end,'<br>Duration:',durationEvent,'days', '<br>Side A:',side_a,':',deaths_a,'deaths','<br>Side B:',side_b,':',deaths_b,'deaths')
  strToReturn <- paste(strToReturn,'<br>Civilians:',deaths_civilians,'deaths','<br>Unknown:',deaths_unknown,'deaths', '<br>Total Deaths:',best,'deaths')                  
  return(strToReturn)
}

getConflictSpecificPlotlyGraph <- function(df){
  titleString = getConflictTitle(df)
  objToReturn = plot_ly(df, x = ~factor(year), y = ~best, type = 'scatter', mode = 'markers', color = ~country, colors = 'Set1',text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo="text") %>% layout(title = titleString, xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of deaths'))
  return(objToReturn)
}

getConflictTitle <- function(df){
  conflictName <- toupper((df[1,])$conflict_name)
  titleString = paste(' Conflict:',conflictName)
  return(titleString)
}

timeLineConflictColumn <- c("region","country","year","date_start","date_end","durationEvent","side_a", "side_b", "deaths_a", "deaths_b","deaths_unknown","deaths_civilians", "best","type_of_violence", "where_coordinates", "conflict_name", "conflict_new_id", "latitude", "longitude","groupsInvolved")

armedConflict_333 <- getEventsWithConflictId(armedConflict, 333)[timeLineConflictColumn]
uniqueCountries_333 <- unique(armedConflict_333$country) # Pakistan and Afghanistan
uniqueCountries_333
```

```{r}
#Boxplot summary for Pakistan for conflict 333
boxplot((armedConflict_333[armedConflict_333$country == 'Pakistan', ])$best)
summary((armedConflict_333[armedConflict_333$country == 'Pakistan', ])$best)
hist((armedConflict_333[armedConflict_333$country == 'Pakistan', ])$best, breaks = 10, xlab = "Deaths", main = "Deaths in Pakistan for 333 conflict")
```
```{r}
# Summary for Afghanistan for 333 conflict
boxplot((armedConflict_333[armedConflict_333$country == 'Afghanistan', ])$best)
summary((armedConflict_333[armedConflict_333$country == 'Afghanistan', ])$best)
hist((armedConflict_333[armedConflict_333$country == 'Afghanistan', ])$best, breaks = 10, xlab = "Deaths", main = "Deaths in Afghanistan for 333 conflict")
```

Clearly the distribution of death count for Afghanistan is highly skewed, Hence we will consider only those events that have led to greater than or equal to 25 deaths.

```{r}
armedConflict_333 <- armedConflict_333[armedConflict_333$country == 'Pakistan' | (armedConflict_333$country == 'Afghanistan' & armedConflict_333$best>25),]

plotly_333 <- getConflictSpecificPlotlyGraph(armedConflict_333)
plotly_333
```

This scatterplot helps us understand the intensity of attacks and subsequent deaths associated with this conflict in Afghanistan.

```{r}
armedConflict_364 <- getEventsWithConflictId(armedConflict, 364)[timeLineConflictColumn]
uniqueCountries_364 <- unique(armedConflict_364$country)
plotly_364 <- getConflictSpecificPlotlyGraph(armedConflict_364)
plotly_364
```

This scatterplot clarifies the intensity of attacks and subsequent attacks in India. 

```{r}
g_asia <- list(
  scope = 'asia',
  projection = list(type = 'Mercator'),
  showframe = FALSE,
  showcoastlines = FALSE
)

plotly_map_333 <- plot_geo(armedConflict_333, lat = ~latitude, lon = ~longitude) %>%
  add_markers(color = ~groupsInvolved,colors = "Dark2",
              symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%
  layout(title = ~getConflictTitle(armedConflict_333), geo = g_asia, showlegend = FALSE)

plotly_map_364 <- plot_geo(armedConflict_364, lat = ~latitude, lon = ~longitude) %>%
  add_markers(color = ~groupsInvolved,colors = "Dark2",
              symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%
  layout(title = ~getConflictTitle(armedConflict_364), geo = g_asia
)

plotly_map_333

plotly_map_364


```

It is clear from the above maps, that the conflict in Afghanistan[Taleban and affiliated organizations] has engulfed the entire country [especially concentrated in North and North-Eastern Afghanistan] whereas the Kashmir insurgency in India is restricted to the bordering areas with Pakistan.

Some other interesting conflicts that should be analyzed are:

**Afghanistan- Islamic State**

```{r}
armedConflict_13637 <- getEventsWithConflictId(armedConflict, 13637)[timeLineConflictColumn]
plotly_map_13637 <- plot_geo(armedConflict_13637, lat = ~latitude, lon = ~longitude) %>%
  add_markers(color = ~groupsInvolved,colors = "Dark2",
              symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%
  layout(title = ~getConflictTitle(armedConflict_13637), geo = g_asia
  )

plotly_map_13637
```

Ever since IS emerged in Afghanistan in 2015, it has tried to expand its control over Northern Afghanistan and this has made North Afghanistan particularly unsafe not only for indigenous population but also neighbouring Central Asian countries having close ties with Moscow. Allegedly, this has brought Taliban and Russia closer as they both see a common enemy IS. [11, 12]

Naturally the terrorist organizations attack each other as is evident in the following graph:

**IS-Taleban**

```{r}
armedConflict_13540 <- getEventsWithConflictId(armedConflict, 13540)[timeLineConflictColumn]
plotly_map_13540 <- plot_geo(armedConflict_13540, lat = ~latitude, lon = ~longitude) %>%
  add_markers(color = ~groupsInvolved,colors = "Dark2",
              symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%
  layout(title = ~getConflictTitle(armedConflict_13540), geo = g_asia
  )

plotly_map_13540
```

Clearly the areas on armed conflicts are common to the regions where both the extremist organizations have stronghold [Northern Afghanistan]. It must be kept in mind that the datset includes the events from 1989-2016. Hence the data for IS in Afghanistan is available only for 2 years, 2015 and 2016.


After Sept 11, 2001 attacks in USA by al-Qaida, USA and its NATO allies launched **Operation Enduring Freedom** which intended to target terrorist mastermind Osama bin Laden’s al-Qaida organization, which was based in the country, as well as the extreme fundamentalist Taliban government that had ruled most of the country since 1996 and supported and protected al-Qaida.[13].

```{r}
armedConflict_418 <- getEventsWithConflictId(armedConflict, 418)[timeLineConflictColumn]
uniqueCountries_418 <- unique(armedConflict_418$country)
plotly_418 <- getConflictSpecificPlotlyGraph(armedConflict_418)

plotly_418
```

```{r}

g_world <- list(
  landcolor = toRGB("gray85"),
  countrycolor = toRGB("white"),
  showland = TRUE,
  showframe = FALSE,
  showcoastlines = FALSE
)

plotly_map_418 <- plot_geo(armedConflict_418, lat = ~latitude, lon = ~longitude) %>%add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%
  layout(title = ~getConflictTitle(armedConflict_418), geo = g_world
  )

plotly_map_418
```

Starting with the al-Qaeda attack on USA in 2001, USA bombed Afghanistan, Pakistan and other countries to eliminate al-Qaeda and Taliban.


Another important conflict waged in the Asian region was the Sri Lankan civil war waged by Liberation Tigers of Tamil Eelam (LTTE) that demanded for a separate Tamilian state in along the eastern coast of  Sri Lanka. This is evident in the following map.

```{r}
armedConflict_352 <- getEventsWithConflictId(armedConflict, 352)[timeLineConflictColumn]
plotly_map_352 <- plot_geo(armedConflict_352, lat = ~latitude, lon = ~longitude) %>%
  add_markers(color = ~groupsInvolved,colors = "Dark2",
              symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%
  layout(title = ~getConflictTitle(armedConflict_352), geo = g_world
  )
plotly_map_352
```



**2. Civilians as primary targets**

```{r}
eventDurDeathCivAsia <- getRegionWiseDurDeathDataset(aggregateDurationDeathConflictCiv, 'Asia')#eventDurDeathCivAsia
dur_death_civ_asia <- getPlotlyGraph(eventDurDeathCivAsia,'Asia',TRUE)

dur_death_civ_asia
```

For the armed conflicts that specifically target civilians, Afghanistan still has the highest number of  civilian casualities [7062] over the course of 18 years. Myanmar, on the other hand has 4273 civilian deaths associated with the Burmese genocide.

```{r}
armedConflict_488 <- getEventsWithConflictId(armedConflict, 488)[timeLineConflictColumn]
plotly_map_488 <- plot_geo(armedConflict_488, lat = ~latitude, lon = ~longitude) %>%
  add_markers(color = ~groupsInvolved,colors = "Dark2",
              symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%
  layout(title = ~getConflictTitle(armedConflict_488), geo = g_asia
  )

plotly_map_488
```

Clearly, the attacks on civilians are concentrated along the eastern borders of Myanmar. Primarily ethnic conflicts, this area has been a hotbed of conflicts between Rakhine Buddhists and Rohingya Muslims which continues even today.


**Region: Africa**

**1. Attacks not targeting civilians**

```{r}
eventDurDeathNonCivAfrica <- getRegionWiseDurDeathDataset(aggregateDurationDeathConflictNonCiv, 'Africa')
dur_death_non_civ_africa <- getPlotlyGraph(eventDurDeathNonCivAfrica,'Africa',FALSE)
dur_death_non_civ_africa

```


As can be seen from the above scatterplot, Eritrean–Ethiopian War (1998-2000) has been one of the bloodiest wars in the African region resulting in 78429 casualities ins short span of 3 years.

```{r}
g_africa <- list(
  scope = 'africa',
  projection = list(type = 'Mercator'),
  showframe = FALSE,
  showcoastlines = FALSE
)

armedConflict_409 <- getEventsWithConflictId(armedConflict, 409)[timeLineConflictColumn]
plotly_map_409 <- plot_geo(armedConflict_409, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_409), geo = g_africa
  )

plotly_map_409
```


```{r}
armedConflict_309 <- getEventsWithConflictId(armedConflict, 309)[timeLineConflictColumn]
plotly_map_309 <- plot_geo(armedConflict_309, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_309), geo = g_africa
  )

plotly_map_309
```

This map shows Africa's longest running civil war that led to creation of South Sudan in 2005. This war led to 48913 deaths over the span of 28 years.


**2. Attacks directed at civilians**

```{r}
eventDurDeathCivAfrica <- getRegionWiseDurDeathDataset(aggregateDurationDeathConflictCiv, 'Africa')#eventDurDeathCivAfrica
dur_death_civ_africa <- getPlotlyGraph(eventDurDeathCivAfrica,'Africa',TRUE)

dur_death_civ_africa
```

African countries have some of the most repressive governments in the world. Most of the countries have dictators e.g. Zimbabwe whereas others are divided along ethno-religious lines. 

```{r}
armedConflict_472 <- getEventsWithConflictId(armedConflict, 472)[timeLineConflictColumn]
plotly_map_472 <- plot_geo(armedConflict_472, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_472), geo = g_africa
  )

plotly_map_472
```

The government crackdown on civilians in Rwanda led to the killings of 511210 civilians. The most apalling of the attacks was the Hutu government backed massacre of Tutsi peopple in 1994 that killed around 300559 civilians. 

Another country that was involved in a civil war for a long time was Sierra Leone [1991-2002].

```{r}
armedConflict_571 <- getEventsWithConflictId(armedConflict, 571)[timeLineConflictColumn]
plotly_map_571 <- plot_geo(armedConflict_571, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_571), geo = g_africa
  )

plotly_map_571

```

The majority of the crimes were perpetrated by rebels from the Armed Forces Revolutionary Council (AFRC) and the Revolutionary United Front (RUF).


**Region: Americas**

**1. Attacks not targeting civilians**

```{r}
eventDurDeathNonCivAmerica <- getRegionWiseDurDeathDataset(aggregateDurationDeathConflictNonCiv, 'Americas')
dur_death_non_civ_america <- getPlotlyGraph(eventDurDeathNonCivAmerica,'Americas',FALSE)
dur_death_non_civ_america
```




```{r}
g_sa <- list(
  scope = 'south america',
  projection = list(type = 'Mercator'),
  showframe = FALSE,
  showcoastlines = FALSE
)



armedConflict_289 <- getEventsWithConflictId(armedConflict, 289)[timeLineConflictColumn]
plotly_map_289 <- plot_geo(armedConflict_289, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_289), geo = g_sa
  )

plotly_map_289
```


Columbia has pretty much been involved in a civil war that began in mid-1960s and continues even today. It is a by-product of Cold War in which USA supported strong anti-communist repression in rural Colombia in the 1960s that led to liberal and communist militants to re-organize into Revolutionary Armed Forces of Columbia (FARC) among many others [14].

```{r}
armedConflict_292 <- getEventsWithConflictId(armedConflict, 292)[timeLineConflictColumn]
plotly_map_292 <- plot_geo(armedConflict_292, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_292), geo = g_sa
  )

plotly_map_292
```

Peru has been engulfed in internal conflict which involves the government of Peru and some terrorist organizations such as 'Shining Path' (Sendero Luminoso) and Movimiento Revolucionario Túpac Amaru (MRTA), both of which support the policy of Marxism-Leninism [15].

```{r}

g_na <- list(
  scope = 'north america',
  projection = list(type = 'Mercator'),
  showframe = FALSE,
  showcoastlines = FALSE
)
armedConflict_4652 <- getEventsWithConflictId(armedConflict, 4652)[timeLineConflictColumn]
plotly_map_4652 <- plot_geo(armedConflict_4652, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_4652), geo = g_na
  )

plotly_map_4652

```


In Mexico, most of the armed attacks have been between Juarez and Sinaloa cartel which are international drug trafficking, money laundering and organized crime syndicates [16]. 


**2. Attacks directed at civilians**

```{r}
eventDurDeathCivAmerica <- getRegionWiseDurDeathDataset(aggregateDurationDeathConflictCiv, 'Americas')
dur_death_civ_america <- getPlotlyGraph(eventDurDeathCivAmerica,'Americas',TRUE)
dur_death_civ_america
```


```{r}
armedConflict_608 <- getEventsWithConflictId(armedConflict, 608)[timeLineConflictColumn]
plotly_map_608 <- plot_geo(armedConflict_608, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_608), geo = g_na
  )

plotly_map_608

```

This represents the attack by Al-Qaida on American soil that led to 2753 civilian deaths within a single day.


**Region: Europe**

**1. Attacks not targeting civilians**

```{r}
eventDurDeathNonCivEurope <- getRegionWiseDurDeathDataset(aggregateDurationDeathConflictNonCiv, 'Europe')
dur_death_non_civ_europe <- getPlotlyGraph(eventDurDeathNonCivEurope,'Europe',FALSE)
dur_death_non_civ_europe
```


```{r}
g_europe <- list(
  scope = 'europe',
  projection = list(type = 'Mercator'),
  showframe = FALSE,
  showcoastlines = FALSE
)

armedConflict_401 <- getEventsWithConflictId(armedConflict, 401)[timeLineConflictColumn]
plotly_map_401 <- plot_geo(armedConflict_401, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_401), geo = g_europe
  )

plotly_map_401

```

The map above timelines the Russo-Chechen conflict starting in 1994 and continuing till 2007. Majority of the attacks have been in the Chechen capital of Grozny as can be seen by the concentration of attacks in the map above. It led to the death of 18,176 people over the span of 14 years. It resulted in the decisive Russian victory and establishment of pro-Russian Chechen government [17], [18]. An interesting point in the above plot is an bomb blast in Doha, Qatar to assassinate Zelimkhan Yandarbiyev [19], [20].


```{r}
armedConflict_389 <- getEventsWithConflictId(armedConflict, 389)[timeLineConflictColumn]
plotly_map_389 <- plot_geo(armedConflict_389, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_389), geo = g_europe
  )

plotly_map_389
```

The above plot represents the Bosnian War from 1992 to 1995 that led to internal partition of Bosmia and Herzegovina. The main belligerants were the forces of republic of Bosnia and Herzegovina and those of the self-proclaimed Bosnian Serb and Bosnian Croat entities within Bosnia and Herzegovina [21].

**2. Attacks directed at civilians.**

```{r}
eventDurDeathCivEurope <- getRegionWiseDurDeathDataset(aggregateDurationDeathConflictCiv, 'Europe')
dur_death_civ_europe <- getPlotlyGraph(eventDurDeathCivEurope,'Europe',TRUE)
dur_death_civ_europe
```


```{r}
armedConflict_4523 <- getEventsWithConflictId(armedConflict, 4523)[timeLineConflictColumn]
plotly_map_4523 <- plot_geo(armedConflict_4523, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_4523), geo = g_europe
  )

plotly_map_4523
```

The Bosnian War saw the first case of genocide in Europe since World War II, a grim reminder of which is Srebrenica massacre of 1995 that led the the killings of 8106 Muslim Bosniaks in July 1995 [22].


**Region: Middle East**

**1. Attacks not targeting civilians**

```{r}
eventDurDeathNonCivME <- getRegionWiseDurDeathDataset(aggregateDurationDeathConflictNonCiv, 'Middle East')
dur_death_non_civ_ME <- getPlotlyGraph(eventDurDeathNonCivME,'Middle East',FALSE)
dur_death_non_civ_ME
```


```{r}
armedConflict_259 <- getEventsWithConflictId(armedConflict, 259)[timeLineConflictColumn]

plotly_map_259 <- plot_geo(armedConflict_259, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_259), geo = g_world
  )

plotly_map_259
```


**2. Attacks directed at civilians**

```{r}
eventDurDeathCivME <- getRegionWiseDurDeathDataset(aggregateDurationDeathConflictCiv, 'Middle East')
dur_death_civ_ME <- getPlotlyGraph(eventDurDeathCivME,'Middle East',TRUE)
dur_death_civ_ME
```


Islamic State (IS) was born during the US invasion of Iraq in 2003. This terrorist outfit has attacked civilians many times sice 2004 and has even spread its influence in the Levant region and hence has become Islamic State in Iraq and the Levant (ISIL). This has led to th death of atleast 14,100 civilians since 2004.


```{r}
armedConflict_506 <- getEventsWithConflictId(armedConflict, 506)[timeLineConflictColumn]

plotly_map_506 <- plot_geo(armedConflict_506, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_506), geo = g_world
  )

plotly_map_506
```

Plot that shows multiple attacks carried out by Islamic State against the states in various countries of the world. IS has become a notorious terrorist organization the world over as is evident by the attacks it has carried against the civilians.

```{r}
armedConflict_501 <- getEventsWithConflictId(armedConflict, 501)[timeLineConflictColumn]

plotly_map_501 <- plot_geo(armedConflict_501, lat = ~latitude, lon = ~longitude) %>% add_markers(color = ~groupsInvolved,colors = "Dark2",symbol = I("circle"), size = ~best,text = ~getConflictSpecificLabel(country,date_start, date_end, durationEvent, side_a, side_b,deaths_a, deaths_b, deaths_civilians,deaths_unknown,best,where_coordinates), hoverinfo = "text")%>%layout(title = ~getConflictTitle(armedConflict_501), geo = g_asia
  )

plotly_map_501
```

Palestinian militant actions escalated in the Gaza strip following the overwhelming election to government of the Islamist political party Hamas in 2005 and 2006. Presently, most of the West Bank is administered by Israel though 42% of it is under varying degrees of autonomous rule by the Fatah-run Palestinian Authority. The Gaza Strip is currently under the control of Hamas. Hamas has launched multiple offensives against the civilians as is evident from the plot above [23].


The above analysis focused on some of the most violent and long-lasting conflicts the world has seen. Many of them are still prevelant today with ever-increasing number of casualities on both sides of the conflict with no end in near future.

**9. In-detail analysis of overall trend of the conflicts throughout the world. [1989-2016]:**

```{r}
varForGroupAttack <- c("groupsInvolved", "best","year", "type_of_violence")
dfGroupAttack <- armedConflict[varForGroupAttack]
updateGroupWiseAttack <- dfGroupAttack %>% group_by(groupsInvolved,type_of_violence)%>%mutate(attacks_by_group = n(), number_of_years = n_distinct(year))
aggregatedGroupWiseAttack <- aggregate(cbind(best) ~ groupsInvolved+attacks_by_group+number_of_years+type_of_violence, updateGroupWiseAttack, FUN = sum)
aggregatedGroupWiseAttack$attacks_per_year <- aggregatedGroupWiseAttack$attacks_by_group/aggregatedGroupWiseAttack$number_of_years
```

We are particularly interested in terrorist organizations.

```{r}
# As we are interested only in Terrorist organizations, delete all those rows that have Govt in them
govtPattern <-"Government"
supPattern<- "Supporters"
repPattern <- "Republic"
forcePattern <-"Forces"
cartelPattern <- "Cartel"
terrorGroupWiseAttackDf <- subset(aggregatedGroupWiseAttack, !str_detect(groupsInvolved, govtPattern) &!str_detect(groupsInvolved, supPattern) & !str_detect(groupsInvolved, repPattern) & !str_detect(groupsInvolved, forcePattern) & !str_detect(groupsInvolved, cartelPattern) & attacks_by_group>10)

# Sort based on number of attacks by group:
terrorOrgAttackGovt <-  subset(terrorGroupWiseAttackDf, type_of_violence == 1)
sortedByAttacksGovt <- terrorOrgAttackGovt[order(-terrorOrgAttackGovt$attacks_per_year),]

terrorOrgAttackCiv <-  subset(terrorGroupWiseAttackDf, type_of_violence == 3)
sortedByAttacksCiv <- terrorOrgAttackCiv[order(-terrorOrgAttackCiv$attacks_per_year),]

top20TerrorOrgAttackGovt <- sortedByAttacksGovt[1:20,]
top20TerrorOrgAttackCiv <- sortedByAttacksCiv[1:20,]

```

**Which are the top 20 most notorious organizations which have led to maximum number of attacks on governments worldwide?**

```{r}
# Top 20 most notorious organizations. [Max # of attacks]
ggplot_notorious_org_govt<-ggplot(data = top20TerrorOrgAttackGovt, aes(x = groupsInvolved, y = attacks_per_year, fill = attacks_per_year))+ theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold")) + geom_bar(stat = "identity")+labs(fill = "Attacks per year") + ggtitle("Most notorious organisations, Attack on Govt.[1989-2016]") + xlab("Organisations") + ylab("Number of attacks per active year") + geom_text(aes(label = paste(attacks_by_group,'attacks:',number_of_years,'years:', best,'deaths')), color = "black",hjust=-0.1, size = 3.5)+scale_y_continuous(limits = c(0,1650)) + scale_fill_gradient(low="blue", high="red")+  coord_flip()

ggplot_notorious_org_govt
```

The above barplot tells us the top 20 organizations that had the highest frequency of attacks per active year from 1989 to 2016. As it can be seen, Taliban has the highest frequency of deadly attacks against the government [1135]. Interestingy, Islamic State (IS) ranks second closely followed by Tehrik-e-Taliban, Pakistan (TTP). Taleban, which was the by-product of Soviet invasion of Afghanistan (1979), has been active ever since. This explains the increasing number of attacks by the organization.

```{r}
listOrgAttackGovt <- unique(top20TerrorOrgAttackGovt$groupsInvolved)

updateGroupWiseAttackPerYear <- dfGroupAttack %>% group_by(groupsInvolved,type_of_violence, year)%>%mutate(attacks_by_group = n())
aggregatedGroupWiseAttackPerYear <- aggregate(cbind(best) ~ groupsInvolved+type_of_violence+year+attacks_by_group, updateGroupWiseAttackPerYear, FUN = sum)

#Sorting by year
aggregatedGroupWiseAttackPerYear = aggregatedGroupWiseAttackPerYear[order(aggregatedGroupWiseAttackPerYear$year),]



#Govt
terrorOrgAttackGovtYearWise <-  subset(aggregatedGroupWiseAttackPerYear, type_of_violence == 1)
top20TerrorOrgAttackGovtYearWise <- subset(terrorOrgAttackGovtYearWise,groupsInvolved %in% listOrgAttackGovt)

trend_yearwise_govt_attack <- plot_ly(top20TerrorOrgAttackGovtYearWise, x = ~factor(year), y = ~attacks_by_group, type = 'scatter', mode = 'lines+markers', color = ~groupsInvolved,colors = "Dark2",text = ~paste('Organization:',groupsInvolved,'<br>Year:',year,'<br>Attacks:',attacks_by_group,'<br>Deaths',best), hoverinfo="text")%>% layout(title = "Trend of attacks on Govt [1989-2016].", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of attacks'))

trend_yearwise_govt_attack
```

Taliban: The Taliban government in Afghanistan was ousted by USA and its allies in 2001. This led to the beginning of the Taliban insurgency in 2002 which continues even today. This can clearly be seen with a steep increase in number of attacks against the government [24].

Islamic state (IS): The attacks by IS have been on a rise especially after the Arab spring that swept the Middle East in 2011.



**Which are the top 20 most notorious organizations which have led to maximum number of attacks on civilians worldwide?**

```{r}
ggplot_notorious_org_civ<-ggplot(data = top20TerrorOrgAttackCiv, aes(x = groupsInvolved, y = attacks_per_year, fill = attacks_per_year))+ theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold")) + geom_bar(stat = "identity")+labs(fill = "Attacks per year") + ggtitle("Most notorious organisations, Attack on Civilians[1989-2016]") + xlab("Organisations") + ylab("Number of attacks per active year") + geom_text(aes(label = paste(attacks_by_group,'attacks:',number_of_years,'years:', best,'deaths')), color = "black",hjust=-0.1, size = 3.5)+scale_y_continuous(limits = c(0,200)) + scale_fill_gradient(low="blue", high="red")+  coord_flip()

ggplot_notorious_org_civ
```

Islamic State (IS) has been the most notorious organization in recent years that has regularly attacked civilians. 


```{r}
listOrgAttackCiv <- unique(top20TerrorOrgAttackCiv$groupsInvolved)
#Civ
terrorOrgAttackCivYearWise <-  subset(aggregatedGroupWiseAttackPerYear, type_of_violence == 3)
top20TerrorOrgAttackCivYearWise <- subset(terrorOrgAttackCivYearWise,groupsInvolved %in% listOrgAttackCiv)

trend_yearwise_civ_attack <- plot_ly(top20TerrorOrgAttackCivYearWise, x = ~factor(year), y = ~attacks_by_group, type = 'scatter', mode = 'lines+markers', color = ~groupsInvolved,colors = "Dark2",text = ~paste('Organization:',groupsInvolved,'<br>Year:',year,'<br>Attacks:',attacks_by_group,'<br>Deaths',best), hoverinfo="text")%>% layout(title = "Trend of attacks on Civilians", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of attacks'))

trend_yearwise_civ_attack
```

Islamic State (IS) : Clearly the attack against civilians have increased over the years starting from the Arab spring of 2011.

Taleban: It has attacked the civilians with extreme brutality which continues to this day.

**Which of the terrorist organizations are most widespread?**

```{r}
## Determine the organizations that are most widespread starts...
varWidespreadOrg <- c("groupsInvolved", "country","latitude", "longitude","code","best") # removing Region
orgWidespreadDf <- armedConflict[varWidespreadOrg]
orgWidespreadDf <- subset(orgWidespreadDf, !str_detect(groupsInvolved, govtPattern) &!str_detect(groupsInvolved, supPattern) & !str_detect(groupsInvolved, repPattern) & !str_detect(groupsInvolved, forcePattern) & !str_detect(groupsInvolved, cartelPattern))

# Step 1: Determine organizations that are active in hightest # of countries
orgWideSpreadCountDf <- orgWidespreadDf %>% group_by(groupsInvolved)%>%mutate(number_active_countries = n_distinct(country))
aggregatedOrgWidespreadDf <- aggregate(cbind(best)~groupsInvolved+country+code+number_active_countries, orgWideSpreadCountDf, FUN = sum)

# Sort by number of countries....
sortedAggregatedOrgWidespreadDf <-aggregatedOrgWidespreadDf[order(-aggregatedOrgWidespreadDf$number_active_countries, aggregatedOrgWidespreadDf$groupsInvolved),]

mostSpreadOrgList <- unique(sortedAggregatedOrgWidespreadDf$groupsInvolved)[1:6]

mostSpreadOrgList
```

```{r}
# 1. IS:
ISAttackedCountries <- sortedAggregatedOrgWidespreadDf[sortedAggregatedOrgWidespreadDf$groupsInvolved == 'IS',]

plotly_map_IS <- plot_geo(ISAttackedCountries) %>%
  add_trace(z = ~best,colors=c("blue","red"),
    text = ~country, locations = ~code,hoverinfo = "text", color = ~best
  ) %>%
  colorbar(title = 'Death count') %>%
  layout(
    title = 'Countries attacked by IS',
    geo = g_world
  )

plotly_map_IS
```

The above maps shows the different countries that the Islamic State or its affiliates have attacked. Clearly, IS has been the most violent in Iraq [in terms of deaths incurred] where it all started. The organization was successful in carrying out multiple attacks throughout the world either conducted by ISIS or inspired by it [25]. As can be seen, the terror organization has swept most of the Sunni dominated countries in the Middle East and Northern Africa [26]. The United States of America has also been attacked by ISIS-inspired organizations [27].

```{r}
#2 al-Qaida
alQaidaAttackedCountries <- sortedAggregatedOrgWidespreadDf[sortedAggregatedOrgWidespreadDf$groupsInvolved == 'al-Qaida ',]

plotly_map_AQ <- plot_geo(alQaidaAttackedCountries) %>%
  add_trace(z = ~best,colors=c("blue","red"),
            text = ~country, locations = ~code,hoverinfo = "text", color = ~best
  ) %>%
  colorbar(title = 'Death count') %>%
  layout(
    title = 'Countries attacked by alQaida',
    geo = g_world
)

plotly_map_AQ
```

Al-Qaida rose up in response to the the Soviet invasion of Afghanistan in 1979 in which the locals and foreign elements [like Osama Bin Laden] came under the umbrella of Mujahideen to free Afghanistan of all external influence. Hence it has caused maximum number of deaths in the Asian countries of Afghanistan and Pakistan. The terrorist outfit marked its presence in USA with the September 11 attacks [28].


```{r}
#3 GSPC
GSPCAttackedCountries <- sortedAggregatedOrgWidespreadDf[sortedAggregatedOrgWidespreadDf$groupsInvolved == 'GSPC',]

plotly_map_GSPC <- plot_geo(GSPCAttackedCountries) %>%
  add_trace(z = ~best,colors=c("blue","red"),
            text = ~country, locations = ~code,hoverinfo = "text", color = ~best
  ) %>%
  colorbar(title = 'Death count') %>%
  layout(
    title = 'Countries attacked by GSPC',
    geo = g_world
  )
plotly_map_GSPC
```

Salafist Group for Preaching and Combat (GSPC) began its attacks in 2007 in the North African country of Algeria and has spread in the surrounding countries. The terror group officially pledged support to al-Qaeda in 2007 and has since formed the basis of al-Qaeda in Islamic Maghreb (AQIM). The group has since declared its attention to attack European and American targets. It aims to overthrow the Algerian government and institute an Islamic state [29,30].


```{r}
alShabaabAttackedCountries <- sortedAggregatedOrgWidespreadDf[sortedAggregatedOrgWidespreadDf$groupsInvolved == 'Al-Shabaab',]

plotly_map_alShabab <- plot_geo(alShabaabAttackedCountries) %>%
  add_trace(z = ~best,colors=c("blue","red"),
            text = ~country, locations = ~code,hoverinfo = "text", color = ~best
  ) %>%
  colorbar(title = 'Death count') %>%
  layout(
    title = 'Countries attacked by al-Shabaab',
    geo = g_world
  )
plotly_map_alShabab
```

Harakat al-Shabaab al-Mujahideen is a jihadist fundamentalist group based out of Somalia in Horn of Africa. In 2012, it pledged its allegiance to al-Qaeda. It supposedly has links with the West African islamist organization of GSPC, now AQIM. 

```{r}
#5 FDLR
FDLRAttackedCountries <- sortedAggregatedOrgWidespreadDf[sortedAggregatedOrgWidespreadDf$groupsInvolved == 'FDLR',]

plotly_map_FDLR <- plot_geo(FDLRAttackedCountries) %>%
  add_trace(z = ~best,colors=c("blue","red"),
            text = ~country, locations = ~code,hoverinfo = "text", color = ~best
  ) %>%
  colorbar(title = 'Death count') %>%
  layout(
    title = 'Countries attacked by FDLR',
    geo = g_world
  )
plotly_map_FDLR
```

The Democratic Forces for the Liberation of Rwanda (FDLR) is an armed group active the Democratic Republic of Congo.

```{r}
LRAAttackedCountries <- sortedAggregatedOrgWidespreadDf[sortedAggregatedOrgWidespreadDf$groupsInvolved == 'LRA',]

plotly_map_LRA <- plot_geo(LRAAttackedCountries) %>%
  add_trace(z = ~best,colors=c("blue","red"),
            text = ~country, locations = ~code,hoverinfo = "text", color = ~best
  ) %>%
  colorbar(title = 'Death count') %>%
  layout(
    title = 'Countries attacked by LRA',
    geo = g_world
  )

plotly_map_LRA
```

Lord's Resistance Army (LRA) is a rebel and heterodox christian cult that operates out of Uganda.It has been accused of widespread violation of human rightsincluding murder, abduction, mutilation, child-sex slavery and forcing children to participate in hostilities [31].


**Countries that have incurred maximum deaths owing to armed conlicts in years from 1989 to 2016**

```{r}
## Determine the countries that have had max civilian deaths....[top 10] starts
countriesMaxOrgDf <- orgWidespreadDf %>% group_by(country)%>%mutate(number_active_org = n_distinct(groupsInvolved))
aggregateCountriesMaxOrgDf <- aggregate(cbind(best)~country+code+number_active_org, countriesMaxOrgDf, FUN = sum)

# Get top 10 countries with highest number of total deaths.
top10DeathCountries <- aggregateCountriesMaxOrgDf[order(-aggregateCountriesMaxOrgDf$best),][1:10,]

plotly_map_maxDeath_country <- plot_geo(top10DeathCountries) %>%
  add_trace(z = ~best,colors=c("blue","red"), color = ~best,
            text = ~country, locations = ~code,hoverinfo = "text"
  ) %>%
  colorbar(title = 'Death count') %>%
  layout(
    title = 'Countries with maximum deaths owing to armed conflicts [1989-2016]',
    geo = g_world
  )

plotly_map_maxDeath_country

```

As is evident from the above map, some countries have had a long history of violent attacks like India, Afghanistan, Pakistan and so on. On the other hand, other countries like Iraq have seen the emergence of some of the world's most notorious terror organizations like ISIS. The conflicts in these countries is pretty much ongoing with no end in near sight.

In most of the wars that are being carried out in the world today, many of the international powers are involved directly or indirectly. The reason for involvement might range from providing military support, weapons and so on to providing intelligence and logistics. One of the many reasons of involvement is that the external powers have to further their interests by involving in proxy wars. This has been a very common trend since Cold War and continues till today.

**10. In-detail analysis of external support in conflicts from 1975 to 2009:**

Now we will use another dataset **'ExternalHelpLarge'** that records the external support in armed conflicts from 1975 to 2009. This is a separate dataset from the 'ArmedConflict' dataset that recorded events from 1989 to 2016. The purpose of this analysis will be to understand the effect external influence has on duration of conflict and how different countries have changed their allegiance over the years.

Note: There was no obvious way to join the two datasets - ArmedConflict and ExternalHelpLarge. So, following is an independent analysis.

```{r}
externalHelp <- read.csv(file = path_concat(dataDirectory, "ExternalHelpLarge.csv"))
#externalHelp <- read.csv("/Users/hardiksahi/Second Term/Stat 847/Project/External influence/ExternalHelpLarge.csv")
externalHelp$total_different_supports <- externalHelp$external_type_troops+externalHelp$external_type_military+externalHelp$external_type_territory+externalHelp$external_type_weapon+externalHelp$external_type_material_log+externalHelp$external_type_training+externalHelp$external_type_economic+externalHelp$external_type_intelligence+externalHelp$external_type_other+externalHelp$external_type_unknown

columnsToKeep <- c("conflictID", "conflict_name", "dyad_id", "dyad_name","primary_actor_name", "external_name","ywp_year","actorID")

```

**11. Trend of direct or indirect involvement of countries in conflicts worldwide**


```{r}
#externalHelp
year_direct_conflict <-  externalHelp %>% group_by(ywp_year) %>% mutate(direct_conflict = n_distinct(country1))
year_direct_conflict_unique <- unique(year_direct_conflict[,c("ywp_year","direct_conflict")])
year_direct_conflict_unique <-year_direct_conflict_unique[order(year_direct_conflict_unique$ywp_year),]


year_external_conflict <- subset(externalHelp, (external_lat != 'NA' & external_long != 'NA')) %>% group_by(ywp_year) %>% mutate(indirect_conflict = n_distinct(external_name))
year_external_conflict_unique <- unique(year_external_conflict[,c("ywp_year","indirect_conflict")])
year_external_conflict_unique <-year_external_conflict_unique[order(year_external_conflict_unique$ywp_year),]

updated_direct_external_conflict <- data.frame(year = year_direct_conflict_unique$ywp_year, direct_count = year_direct_conflict_unique$direct_conflict, external_count = year_external_conflict_unique$indirect_conflict)

trend_direct_external_conflict_countries <- plot_ly(data =updated_direct_external_conflict,x = ~factor(year))%>% add_trace(y=~direct_count, name = 'Direct conflict', mode = 'lines+markers',type = 'scatter')%>% add_trace(y=~external_count, name = 'Indirect conflict', mode = 'lines+markers',type = 'scatter')%>% layout(title = "Trend of countries getting involved in conflicts", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of countries'))
trend_direct_external_conflict_countries
```

As expected, more and more countries are getting involved in conflicts indirectly by being a foreign power providing support to the primary warring parties. On the other hand, the number of countries involved in direct conflicts has more or less stayed the same.

We can roughly divide the conflicts into 3 types:
1. Countries fighting against each other. (Country1 and Country2 are main belligerents)
2. Country fighting to gain territory.
3. Country fighting aginst an organization to take control of governance.

We will perform detailed analysis for each of the above 3 categories.

```{r}
hyphen <- "-"
roundBracketBeg <- "\\("
roundBracketEnd <- "\\)"

subsetWithColumns <- externalHelp[columnsToKeep]
dfCountriesFighting <- subset(subsetWithColumns, str_detect(externalHelp$conflict_name, hyphen) & !str_detect(externalHelp$conflict_name, roundBracketBeg) & !str_detect(externalHelp$conflict_name, roundBracketEnd))

dfCountriesFighting <- dfCountriesFighting[order(dfCountriesFighting$ywp_year),]


conflictsWithCountriesFighting <- dfCountriesFighting %>% group_by(conflictID) %>% mutate(year_count = n_distinct(ywp_year))

uniqueConflictsCountriesFight <- unique(conflictsWithCountriesFighting[,c('conflictID','conflict_name','year_count')])
numberConflictsCountryFighting <- NROW(uniqueConflictsCountriesFight)
numberConflictsCountryFighting
```

```{r}
dfCountriesForTerritory <- subset(subsetWithColumns, !str_detect(externalHelp$conflict_name, hyphen) & str_detect(externalHelp$conflict_name, roundBracketBeg) & str_detect(externalHelp$conflict_name, roundBracketEnd))

dfCountriesForTerritory <- dfCountriesForTerritory[order(dfCountriesForTerritory$ywp_year),]

conflictsWithCountriesTerritory <- dfCountriesForTerritory %>% group_by(conflictID) %>% mutate(year_count = n_distinct(ywp_year))

uniqueConflictsCountriesTerr <- unique(conflictsWithCountriesTerritory[,c('conflictID','conflict_name','year_count')])
numberConflictsCountriesTerritory <- NROW(uniqueConflictsCountriesTerr)
numberConflictsCountriesTerritory
```

```{r}
dfCountriesForGovernance <- subset(subsetWithColumns, !str_detect(externalHelp$conflict_name, hyphen) & !str_detect(externalHelp$conflict_name, roundBracketBeg) & !str_detect(externalHelp$conflict_name, roundBracketEnd))

dfCountriesForGovernance <- dfCountriesForGovernance[order(dfCountriesForGovernance$ywp_year),]

conflictsWithCountriesGovernance <- dfCountriesForGovernance %>% group_by(conflictID) %>% mutate(year_count = n_distinct(ywp_year))

uniqueConflictsCountriesGov <- unique(conflictsWithCountriesGovernance[,c('conflictID','conflict_name','year_count')])

numberConflictsCountriesGovernance <- NROW(uniqueConflictsCountriesGov)
numberConflictsCountriesGovernance
```


Now let's create a dataframe to capture the above numbers.

```{r}
# create a dataframe that captures the above numbers
conflictReasonCountDf <- data.frame(attack_for_territory = numberConflictsCountriesTerritory, attack_on_country = numberConflictsCountryFighting, attack_for_governance = numberConflictsCountriesGovernance)
conflictReasonCountDf
```

```{r}
getSubsetForConflict <- function(confID){
  return(subset(externalHelp, conflictID == confID))
}

getConflictNameFromSubset <- function(conflictSubset){
  return(conflictSubset$conflict_name[1])
}

getYearsForConflict <- function(conflictSubset){
  return(sort(unique(conflictSubset$ywp_year)))
}

getConflictSubsetForYear<- function(year, conflictSubset){
  return(subset(conflictSubset, ywp_year == year))
}

getDyadsInConflictForYear <- function(conflictSubsetYear){
  return(unique(conflictSubsetYear$dyad_id))
}

getDyadNameInConflict <- function(subset_for_dyad){
  return(subset_for_dyad$dyad_name[1])
}

getHoverText <- function(country, ext_type_text){
  strToReturn = paste('Country:',country,'<br>Support areas:',ext_type_text)
  return(strToReturn)
}

getHoverTextFight <- function(country){
  strToReturn = paste('Conflict Country:',country,'<br>Receives support from the connected countries.')
  return(strToReturn)
}

getTitle <- function(confName, dyadName){
  strToReturn = paste('Conflict Name:', confName, ' Sides Fighting:', dyadName)
  return(strToReturn)
}

g_world <- list(
  projection = list(type = 'Mercator'),
  landcolor = toRGB("gray95"),
  #countrycolor = toRGB("gray80"),
  showland = TRUE,
  showframe = FALSE,
  showcoastlines = TRUE,
  subunitcolor = toRGB("white"),
  showcountries = F
)


mapList <- list()
count <-1

functionForEachDyadInYear = function(dyad_id, conflictSubsetYear,conflict_name, conflict_year, conflict_type){
  #browser()
  conflict_gyear_gdyad <- subset(conflictSubsetYear, dyad_id == dyad_id) # dyad rows for a given conflict, given year.
  dyad_name_gconflict_gyear_gdyad <- getDyadNameInConflict(conflict_gyear_gdyad)
  
  unique_actor_actorID_given_dyad <- unique(conflict_gyear_gdyad[,c("actorID","primary_actor_name")])
  unique_actors_given_dyad_list <- unique(unique_actor_actorID_given_dyad$actorID) # all the actors that received aid in this dyad.
  
  
  # Now let's get information for 2 sides in the conflict [country1, country2]
  
  if(conflict_type == between_countries){
    # Has both sides as countries [country1, country2]
    country1_given_conflict_dyad_year<- unique(conflict_gyear_gdyad[,c("country1", "code1","country1id","country1_lat","country1_long")])
    country2_given_conflict_dyad_year<- unique(conflict_gyear_gdyad[,c("country2", "code2","country2id","country2_lat","country2_long")])
    
  }
  else if(conflict_type == govt_nongovt){
    # Has only side 1 as country and side 2 as rebel group.
    country1_given_conflict_dyad_year<- unique(conflict_gyear_gdyad[,c("country1", "code1","country1id","country1_lat","country1_long")])
  }
  
  # countryName, countrycode, differSupp, marker_lat, marker_long, start_lat, start_long,end_lat, end_long, ONSIDE 
  # countryName, countrycode, differSupp, marker_lat, marker_long, start_lat, start_long,end_lat, end_long, ONSIDE
  
  colNamesMainCountries <- c("name","code","lat","long")
  # Country 1 DF
  country1_name <- country1_given_conflict_dyad_year[,c("country1")]
  country1_code <- country1_given_conflict_dyad_year[,c("code1")]
  country1_lat <- country1_given_conflict_dyad_year[,c("country1_lat")]
  country1_long <-country1_given_conflict_dyad_year[,c("country1_long")]
  
  country1_df <- data.frame(country1_name,country1_code,country1_lat,country1_long)
  names(country1_df) <- colNamesMainCountries
  
  
  if(conflict_type == between_countries){ # Scenario when 2nd side is ALSO a COUNTRY
    country2_name <- country2_given_conflict_dyad_year[,c("country2")]
    country2_code <- country2_given_conflict_dyad_year[,c("code2")]
    country2_lat <- country2_given_conflict_dyad_year[,c("country2_lat")]
    country2_long <-country2_given_conflict_dyad_year[,c("country2_long")]
    country2_df <- data.frame(country2_name,country2_code,country2_lat,country2_long)
    names(country2_df) <- colNamesMainCountries
  }
  else if(conflict_type == govt_nongovt){ # When 2nd party is a faction that is based in Country1... => Just set name as name as faction and LAT LONG jittered
    country2_code <- country1_given_conflict_dyad_year[,c("code1")]
    country1_id <- country1_given_conflict_dyad_year[,c("country1id")]
    country2_name <- (subset(unique_actor_actorID_given_dyad, actorID != country1_id))$primary_actor_name
    
    if(length(country2_name) == 0){ #=> no row for Side 1. => only rows for side 2
      country2_name <- "No support for side2"
    }
    country2_lat <- jitter(country1_given_conflict_dyad_year[,c("country1_lat")])
    country2_long <-jitter(country1_given_conflict_dyad_year[,c("country1_long")])
    country2_df <- data.frame(country2_name,country2_code,country2_lat,country2_long)
    names(country2_df) <- colNamesMainCountries
  }
  
  isCountry1Supp <- FALSE
  isCountry2Supp <- FALSE
  columnsForSupporters <- c("external_name","external_code","total_different_supports","external_lat","external_long","external_type_text") # They are already in the dataset
  #columnsExtraForSupporters <- c("start_lat", "start_long","end_lat", "end_long","onside") # Columns to compute on fly
  
  for(actorIDN in unique_actors_given_dyad_list){ # at max 2 actors.
    if(actorIDN == country1_given_conflict_dyad_year$country1id){
      # Supporters for side1
      side1_supporters <-  unique(subset(conflict_gyear_gdyad, actorID == actorIDN)[,columnsForSupporters])
      side1_supporters$start_lat <- side1_supporters$external_lat
      side1_supporters$start_long <- side1_supporters$external_long
      side1_supporters$end_lat <- country1_df$lat
      side1_supporters$end_long <- country1_df$long
      side1_supporters$onside <- rep(2,nrow(side1_supporters))
      isCountry1Supp <- TRUE
      #print(paste("#Supporters on side 1",nrow(side1_supporters)))
    }
    else {
      # Supporters for side2 [country of faction.]
      side2_supporters <-  unique(subset(conflict_gyear_gdyad, actorID == actorIDN)[,columnsForSupporters])
      side2_supporters$start_lat <- side2_supporters$external_lat
      side2_supporters$start_long <- side2_supporters$external_long
      side2_supporters$end_lat <- country2_df$lat
      side2_supporters$end_long <- country2_df$long
      side2_supporters$onside <- rep(4,nrow(side2_supporters))
      isCountry2Supp <- TRUE
      #print(paste("#Supporters on side 2",nrow(side2_supporters)))
    }
  }
  
  plotly_map <- plot_geo() %>% layout(geo = g_world, title = ~getTitle(conflict_name, dyad_name_gconflict_gyear_gdyad), showlegend = FALSE)
  if(isCountry1Supp && isCountry2Supp){
    #Adding segments and markers for supporters of SIDE1
    plotly_map <- add_segments(plotly_map,data = side1_supporters,x = ~start_long, xend = ~end_long, y = ~start_lat, yend = ~end_lat, alpha = 1, hoverinfo = "none",color = I("red"))
    plotly_map <- add_markers(plotly_map,data = side1_supporters,  x = ~external_long, y = ~external_lat, text = ~getHoverText(external_name, external_type_text), hoverinfo = "text",alpha = 0.3,color = I("red"),marker=list(size=15))
    plotly_map <- add_text(plotly_map,data = side1_supporters,  x = ~external_long, y = ~external_lat, text = ~external_name, color = I("red"), hoverinfo = "none")
    
    
    #Adding segments and markers for supporters of SIDE2
    plotly_map <- add_segments(plotly_map,data = side2_supporters,x = ~start_long, xend = ~end_long, y = ~start_lat, yend = ~end_lat, alpha = 1, hoverinfo = "none",color = I("blue"))
    plotly_map <- add_markers(plotly_map,data = side2_supporters,  x = ~external_long, y = ~external_lat, text = ~getHoverText(external_name, external_type_text), hoverinfo = "text",alpha = 0.3,color = I("blue"),marker=list(size=15))
    plotly_map <- add_text(plotly_map,data = side2_supporters,  x = ~external_long, y = ~external_lat, text = ~external_name, color = I("blue"), hoverinfo = "none")
    
  }
  else if(isCountry1Supp && !isCountry2Supp){
    #Adding segments and markers for supporters of SIDE1
    plotly_map <- add_segments(plotly_map,data = side1_supporters,x = ~start_long, xend = ~end_long, y = ~start_lat, yend = ~end_lat, alpha = 1, hoverinfo = "none",color = I("red"))
    plotly_map <- add_markers(plotly_map,data = side1_supporters,  x = ~external_long, y = ~external_lat, text = ~getHoverText(external_name, external_type_text), hoverinfo = "text",alpha = 0.3,color = I("red"),marker=list(size=15))
    plotly_map <- add_text(plotly_map,data = side1_supporters,  x = ~external_long, y = ~external_lat, text = ~external_name, color = I("red"), hoverinfo = "none")
    
  }
  else if(!isCountry1Supp && isCountry2Supp){
    #Adding segments and markers for supporters of SIDE2
    plotly_map <- add_segments(plotly_map,data = side2_supporters,x = ~start_long, xend = ~end_long, y = ~start_lat, yend = ~end_lat, alpha = 1, hoverinfo = "none",color = I("blue"))
    plotly_map <- add_markers(plotly_map, data = side2_supporters,  x = ~external_long, y = ~external_lat, text = ~getHoverText(external_name, external_type_text), hoverinfo = "text",alpha = 0.3,color = I("blue"),marker=list(size=15))
    plotly_map <- add_text(plotly_map,data = side2_supporters,  x = ~external_long, y = ~external_lat, text = ~external_name, color = I("blue"), hoverinfo = "none")
    
    
  }
  
  #Adding markers for SIDE1
  plotly_map <- add_markers(plotly_map, data = country1_df,x = ~long, y = ~lat, marker=list(size = 18,symbol = "x"), text = ~getHoverTextFight(name), hoverinfo = "text",color = I("red"),alpha = 0.3)
  
  plotly_map <- add_text(plotly_map, data = country1_df,x = ~long, y = ~lat,text = ~name,color = I("red"), hoverinfo = "none")
  
  #Adding markers for SIDE2
  plotly_map <- add_markers(plotly_map, data = country2_df,x = ~long, y = ~lat, marker=list(size = 18,symbol = "x"),text = ~getHoverTextFight(name), hoverinfo = "text",color = I("blue"),alpha = 0.3)
  plotly_map <- add_text(plotly_map, data = country2_df,x = ~long, y = ~lat,text = ~name,color = I("blue"), hoverinfo = "none")
  
  
  # Text for year
  plotly_map <- add_text(plotly_map, x = 150, y = 80, text = conflict_year, color = I("black"),textfont = list(color = '#000000', size = 16), hoverinfo = "none")
  
  #browser()
  mapList[[count]] <<- plotly_map
  count<<-count+1
}

functionForEachYear <- function(year, conflictSubset, conflictName, conflict_type){
  conflict_subset_year <- getConflictSubsetForYear(year, conflictSubset)
  dyads_conflict_year <- getDyadsInConflictForYear(conflict_subset_year)
  #print(paste("Dyad count in year ", year, "is", length(dyads_conflict_year)))
  lapply(dyads_conflict_year, FUN = functionForEachDyadInYear, conflictSubsetYear = conflict_subset_year, conflict_name = conflictName, conflict_year = year, conflict_type = conflict_type)
  # For each dyad for a given year:
}

between_countries <- "between_countries"
govt_nongovt <- "govt_nongovt"
```


**1. Countries fighting against each other**

```{r}
subsetColumnsNames <- c('conflictID', 'conflict_name', 'dyad_id', 'dyad_name', 'external_name')
furtherSubsetCountriesFighting <- conflictsWithCountriesFighting[subsetColumnsNames]
conflictCountriesFightingExternalSupp <- furtherSubsetCountriesFighting %>% group_by(conflictID, conflict_name) %>% mutate(external_sup_count = n_distinct(external_name))

uniqueConflictsCountriesFightSupportCount <- unique(conflictCountriesFightingExternalSupp[,c("conflictID","conflict_name","external_sup_count")])

ggplot_external_count_country_fight <- ggplot(data = uniqueConflictsCountriesFightSupportCount, aes(x = conflict_name, y = external_sup_count, fill = external_sup_count)) + theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold")) + geom_bar(stat = "identity")+labs(fill = "Number of External players") + ggtitle("External players in a inter-country conflict [1975-2009]") + xlab("Country1 - Country2") + ylab("Number of external players")+ geom_text(aes(label = paste(external_sup_count, ": Conflict_ID",conflictID)), color = "black",hjust=-0.1, size = 3.5) + scale_y_continuous(limits = c(0,60)) + scale_fill_gradient(low="blue", high="red")+  coord_flip()

ggplot_external_count_country_fight
```


From the barplot above, we can clearly see that US invasion of Iraq in 2003 had the maximum number of external supporters (45) followed by Iraqi invasion of Kuwait in 1991 and Iran-Iraq war in 1980. 


**a) Ethiopia-Somalia war**: We will try to understand different countries that provide support to the two sides over the years of the conflict.

```{r}
count <- 1
mapList <- list()
conflict_71_subset <- getSubsetForConflict(71)
conflict_71_name <- getConflictNameFromSubset(conflict_71_subset)
years_conflict_71 <- getYearsForConflict(conflict_71_subset)
lapply(years_conflict_71, FUN = functionForEachYear,conflictSubset=conflict_71_subset, conflictName=conflict_71_name, conflict_type = between_countries)
conflict71_subplot <- subplot(mapList, nrows = 3) 
conflict71_subplot
```

The Ogaden War or Ethiopia-Somalia war is a classic example of the **Cold War tensions** between the two blocks of the world- **Allied and Axis powers** [32]. The war took place between 1977 to 1980 and were supported by Soviet Union (Russia), Cuba and East Germany on the Ethiopian side and USA through its Arab allies on the Somalian side. This gives us a clear indication of the proxy wars that the two world superpowers involved in investing heavily in training, weapons, military and logistics support [33]. The war ended with Somalian defeat.

**b) Iran- Iraq war**

```{r}
count <- 1
mapList <- list()
conflict_128_subset <- getSubsetForConflict(128)
conflict_128_name <- getConflictNameFromSubset(conflict_128_subset)
years_conflict_128 <- getYearsForConflict(conflict_128_subset)
lapply(years_conflict_128, FUN = functionForEachYear,conflictSubset=conflict_128_subset, conflictName=conflict_128_name, conflict_type = between_countries)
conflict128_subplot <- subplot(mapList, nrows = 3)
conflict128_subplot
```

Iraq invaded Iran in 1980, just the year after the Islamic Revolution had overthrown the pro-West Shah of Iran and converted Iran into a theocracy. With the exception of Libya and Syria, entire support was for the Saddam Hussein's Iraq. Interestingly this happened during the peak of Cold War and USA (and allies) and Soviet Union (and allies) both supported Iraq. This was due to Iran's slogan of "neither East nor West". With active sale of arms to Iraq, both the superpowers could not accept the downfall of Saddam's regime and hence provided full support for the same [34,35].

**c) Iraq invasion of Kuwait (1990, leading to the start of the Gulf War)**

```{r}
count <- 1
mapList <- list()
conflict_176_subset <- getSubsetForConflict(176)
conflict_176_name <- getConflictNameFromSubset(conflict_176_subset)
years_conflict_176 <- getYearsForConflict(conflict_176_subset)
lapply(years_conflict_176, FUN = functionForEachYear,conflictSubset=conflict_176_subset, conflictName=conflict_176_name, conflict_type = between_countries)
conflict176_subplot <- subplot(mapList, nrows = 1)

conflict176_subplot
```

By the time the Iran–Iraq War ended, Iraq was not in a financial position to repay the US$14 billion it borrowed from Kuwait to finance its war. Inability to repay the debt to Kuwait, Iraq decided to invade Kuwait in 1990 which culminated in a decisive Iraqi victory with Kuwait being declared as the 19th province of Iraq. This led to the start of the Gulf War which involved a US led coalition of 31 countries attacking the Iraqi forces backed only by Yemen and Palestine.
In an interesting turn of events, the US led coalition which had supported Iraq in Iran-Iraq war turned offensive against  Saddam Hussein's regime during the Gulf War[36].


**d) USA invasion of Iraq (2003)**

```{r}
count <- 1
mapList <- list()
conflict_226_subset <- getSubsetForConflict(226)
conflict_226_name <- getConflictNameFromSubset(conflict_226_subset)
years_conflict_226 <- getYearsForConflict(conflict_226_subset)
lapply(years_conflict_226, FUN = functionForEachYear,conflictSubset=conflict_226_subset, conflictName=conflict_226_name, conflict_type = between_countries)
conflict226_subplot <- subplot(mapList, nrows = 1)
conflict226_subplot
```

The above map shows the support USA had in its invasion of Iraq in 2003. The entire world was involved in this War on Terror.

By the above analysis, it can be seen that the world has pretty much been involved in fight for oil reserves. This is one of the major reasons that Middle East is such an unstable place.



**2. Countries fighting against non government faction for governance in a country.**

```{r}
furtherSubsetCountriesGovernance <- conflictsWithCountriesGovernance[subsetColumnsNames]
conflictCountriesGovernanceExternalSupp <- furtherSubsetCountriesGovernance %>% group_by(conflictID, conflict_name) %>% mutate(external_sup_count = n_distinct(external_name))

uniqueConflictsGovernanceFightSupportCount <- unique(conflictCountriesGovernanceExternalSupp[,c("conflictID","conflict_name","external_sup_count")])


ggplot_external_count_country_governance <- ggplot(data = uniqueConflictsGovernanceFightSupportCount, aes(x = conflict_name, y = external_sup_count, fill = external_sup_count)) + theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold")) + geom_bar(stat = "identity")+labs(fill = "Number of External players") + ggtitle("External players in a fight against a non government faction [1975-2009]") + xlab("Country in conflict") + ylab("Number of external players")+ geom_text(aes(label = paste(external_sup_count, ": Conflict_ID",conflictID)), color = "black",hjust=-0.1, size = 3.5) + scale_y_continuous(limits = c(0,80)) + scale_fill_gradient(low="blue", high="red")+  coord_flip()

ggplot_external_count_country_governance
```

Afghanistan and Iraq have long been involved in armed conflicts against various terrorist organizations that have their stronghold in the country. [Taliban and ISIS]. Interestingly US has 33 external supporters in its War On Terror which involved support from all of its NATO allies amongst many other countries.

NOTE: In the following scenarios, one of the sides in the conflict is a non government organisation. Because it cannot be attributed to a specific country, I have jittered the latitude and longitude of the country where it is associated and marked it as the location of the non governement faction. This is only for representative purpose and does not aim to serve as the exact location of the faction.

**a) Country: Afghanistan**

```{r}
getAllDyadsInConflict <- function(conflictSubset){
  return(unique(conflictSubset$dyad_id))
}

getConflictSubsetGivenDyad <- function(conflictSubset, dyadId){
  return(subset(conflictSubset, dyad_id == dyadId))
}

conflict_137_subset <- getSubsetForConflict(137)
conflict_137_name <- getConflictNameFromSubset(conflict_137_subset)
conflict_137_dyads <- getAllDyadsInConflict(conflict_137_subset)

```

Many organizations have fought the government of Afghanistan to get hold of governance in the country. It must be carefully noted that government here refers to the ruling party of the country - Najibullah government, then the Taliban government and so on. 

**i) Government of Afghanistan - Harakat-i Inqilab-i Islami-yi Afghanistan**

```{r}
count <- 1
mapList <- list()
conflict_137_dyad_731 <- getConflictSubsetGivenDyad(conflict_137_subset, 731) # Hardcoded dyad ID.
years_conflict_137_dyad_731 <- getYearsForConflict(conflict_137_dyad_731)
lapply(years_conflict_137_dyad_731, FUN = functionForEachYear,conflictSubset=conflict_137_dyad_731, conflictName=conflict_137_name, conflict_type = govt_nongovt)
conflict137_dyad_731_subplot <- subplot(mapList, nrows = 3)

conflict137_dyad_731_subplot
```

Government of Afghanistan (Communist) : Red

Harakat-i Inqilab-i Islami-yi Afghanistan : Blue

As can be seen in the maps plotted above, the Communist government of Afghanistan was fully supported by Soviet Union which invaded Afghanistan in 1979. Understandably, the anti-communist  Harakat-i Inqilab-i Islami-yi Afghanistan party was backed by US and it's allies from 1980 to 1988.


**ii) Government of Afghanistan - Hizb-i Islami-yi Afghanistan**

```{r}
count <- 1
mapList <- list()
conflict_137_dyad_412 <- getConflictSubsetGivenDyad(conflict_137_subset, 412) # Hardcoded dyad ID.
years_conflict_137_dyad_412 <- getYearsForConflict(conflict_137_dyad_412)
lapply(years_conflict_137_dyad_412, FUN = functionForEachYear,conflictSubset=conflict_137_dyad_412, conflictName=conflict_137_name, conflict_type = govt_nongovt)
conflict137_dyad_412_subplot <- subplot(mapList, nrows = 6)

conflict137_dyad_412_subplot
```

Government of Afghanistan (Communist): Red

Hizb-i Islami-yi Afghanistan: Blue

The conflict between communist Afganistan government and anti-communist Hizb-i Islami-yi Afghanistan organization is another grim reminder of the Cold War between USA and USSR. USSR backed the Najibullah led communist government till its downfall in 1991.


**iii) Government of Afghanistan - Taleban**

```{r}
count <- 1
mapList <- list()
conflict_137_dyad_327 <- getConflictSubsetGivenDyad(conflict_137_subset, 327) # Hardcoded dyad ID.
years_conflict_137_dyad_327 <- getYearsForConflict(conflict_137_dyad_327)
lapply(years_conflict_137_dyad_327, FUN = functionForEachYear,conflictSubset=conflict_137_dyad_327, conflictName=conflict_137_name, conflict_type = govt_nongovt)
conflict137_dyad_327_subplot <- subplot(mapList, nrows = 3)

conflict137_dyad_327_subplot
```

Government of Afghanistan: Red 

Taleban: Blue

Ever since the establishment of the Taleban in the mid nineties, Pakistan has been it's staunch supporter, providing training, weapons, personnel and intelligence support via ISI (Intelligence agency of Pakistan). 
Pakistan, Saudi Arabis and UAE were the only 3 countries which recognized Taliban as the legitimate government of Afghanistan when it came to power in 1996.
The Taliban government ruled Afghanistan from 1996 till 2001 when US led coalition invaded Afghanistan and toppled the Taleban government. Interestingly, we can see that Taleban has found an unlikely ally in Shia majority Iran.
By providing limited support to the Taliban, Iran is hitting two birds with one stone: creating a buffer against ISIS and preventing the United States from using Afghanistan as a base against Iran [37].


**iv) Government of Afghanistan - UIFSA (The Northern Alliance or United Islamic Front for Salvation of Afghanistan)**

```{r}
count <- 1
mapList <- list()
conflict_137_dyad_423 <- getConflictSubsetGivenDyad(conflict_137_subset, 423) # Hardcoded dyad ID.
years_conflict_137_dyad_423 <- getYearsForConflict(conflict_137_dyad_423)
lapply(years_conflict_137_dyad_423, FUN = functionForEachYear,conflictSubset=conflict_137_dyad_423, conflictName=conflict_137_name, conflict_type = govt_nongovt)
conflict137_dyad_423_subplot <- subplot(mapList, nrows = 3)

conflict137_dyad_423_subplot
```

Government of Afghanistan(Taleban) : Red

UIFSA : Blue

Note: Here government is that of the Taliban [1996-2001].

UIFSA was a coalition of militias seeking to topple the Taliban government in Afghanistan. Throughout its course, Taliban was supported by Pakistan, Saudi Arabia amongst other Sunni majority Arab countries until 1999 when Saudi Arabia withdrew support to Taliban [40]. 


**b) USA (Invasion of Afghanistan to capture Osama bin Laden and topple the Taleban government)**

```{r}
conflict_224_subset <- getSubsetForConflict(224)
conflict_224_name <- getConflictNameFromSubset(conflict_224_subset)
conflict_224_dyads <- getAllDyadsInConflict(conflict_224_subset)

count <- 1
mapList <- list()
conflict_224_dyad_360 <- getConflictSubsetGivenDyad(conflict_224_subset, 360) # Hardcoded dyad ID.
years_conflict_224_dyad_360 <- getYearsForConflict(conflict_224_dyad_360)
lapply(years_conflict_224_dyad_360, FUN = functionForEachYear,conflictSubset=conflict_224_dyad_360, conflictName=conflict_224_name, conflict_type = govt_nongovt)
conflict224_dyad_360_subplot <- subplot(mapList, nrows = 4)

conflict224_dyad_360_subplot
```

USA: Red

Al-Qaeda: Blue

After the September 11, 2001 attacks in USA by al-Qaeda, US with its allies declared War on Terror and invaded Afghanistan. 

**3. Countries fighting to control territory**

```{r}
furtherSubsetCountriesTerritory <- conflictsWithCountriesTerritory[subsetColumnsNames]
conflictCountriesTerritoryExternalSupp <- furtherSubsetCountriesTerritory %>% group_by(conflictID, conflict_name) %>% mutate(external_sup_count = n_distinct(external_name))

uniqueConflictsTerritoryFightSupportCount <- unique(conflictCountriesTerritoryExternalSupp[,c("conflictID","conflict_name","external_sup_count")])


ggplot_external_count_country_territory <- ggplot(data = uniqueConflictsTerritoryFightSupportCount, aes(x = conflict_name, y = external_sup_count, fill = external_sup_count)) + theme(plot.title = element_text(face = "bold.italic",hjust = 0.5), axis.title.x = element_text(size = 14, face = "bold"), axis.title.y = element_text(size = 14, face = "bold")) + geom_bar(stat = "identity")+labs(fill = "Number of External players") + ggtitle("External players in a conflict to access territory [1975-2009]") + xlab("Country (Territory)") + ylab("Number of external players")+ geom_text(aes(label = paste(external_sup_count, ": Conflict_ID",conflictID)), color = "black",hjust=-0.1, size = 3.5)+ scale_y_continuous(limits = c(0,25)) + scale_fill_gradient(low="blue", high="red")+  coord_flip()

ggplot_external_count_country_territory
```

From the barplot above, we can see that Ethiopia-Somalia war [1977-1978] over the disputed territory of Ogaden had 19 foreign powers. The power struggle represented the proxy war scene during the Cold War.
It can also be clearly seen that Africa and Middle East regions have the maximum number of external forces involved in wars.


**a) Israel (Palestine)**

```{r}
conflict_37_subset <- getSubsetForConflict(37)
conflict_37_name <- getConflictNameFromSubset(conflict_37_subset)
conflict_37_dyads <- getAllDyadsInConflict(conflict_37_subset)
```

**i) Government of Israel against Fatah.**
```{r}
count <- 1
mapList <- list()
conflict_37_dyad_377 <- getConflictSubsetGivenDyad(conflict_37_subset, 377) # Hardcoded dyad ID.
years_conflict_37_dyad_377 <- getYearsForConflict(conflict_37_dyad_377)
lapply(years_conflict_37_dyad_377, FUN = functionForEachYear,conflictSubset=conflict_37_dyad_377, conflictName=conflict_37_name, conflict_type = govt_nongovt)
conflict37_dyad_377_subplot <- subplot(mapList, nrows = 3)

conflict37_dyad_377_subplot
```

United States has been a staunch supporter of Israel in its fight against Fatah. 

**ii) Government of Israel against Hamas**

```{r}
count <- 1
mapList <- list()
conflict_37_dyad_381 <- getConflictSubsetGivenDyad(conflict_37_subset, 381) # Hardcoded dyad ID.
years_conflict_37_dyad_381 <- getYearsForConflict(conflict_37_dyad_381)
lapply(years_conflict_37_dyad_381, FUN = functionForEachYear,conflictSubset=conflict_37_dyad_381, conflictName=conflict_37_name, conflict_type = govt_nongovt)
conflict37_dyad_381_subplot <- subplot(mapList, nrows = 4)

conflict37_dyad_381_subplot
```

Hamas has always been supported by Iran and Syria whereas Israel is supported by United States.

Fatah and Hamas have been fighting against Zionist occupation of Israel and have been demanding establishment of Palestine. However there are some differences in the ideologies of the two organisations which makes them fight against each other as well [41].

**12. Number of external countries getting involved in a conflict increasing with time**


```{r}
externalSupportColumns <- c("external_name", "external_code","external_lat","external_long","ywp_year")

countriesGivingSupport <- externalHelp[externalSupportColumns] # 4869

#Get rid of non country support:
onlyCountriesSupport <- subset(countriesGivingSupport, (external_lat != 'NA' & external_long != 'NA')) #4135

#1 For a given year, how many unique countries are involved.

uniqueCountForGivenYear <- onlyCountriesSupport %>% group_by(ywp_year) %>% mutate(unique_country_count_year =n_distinct(external_name))

extractYearCountryCount <- subset(uniqueCountForGivenYear, select=c("ywp_year", "unique_country_count_year"))

sortedByYearCountryCount <- unique(extractYearCountryCount[with(extractYearCountryCount, order(ywp_year)),][,c('ywp_year','unique_country_count_year')])
  
#Plot the line chart over the years....

trend_yearwise_country_count <- plot_ly(sortedByYearCountryCount, x = ~factor(ywp_year), y = ~unique_country_count_year, type = 'scatter', mode = 'line',text = ~paste('Country count:',unique_country_count_year,'<br>Year:',ywp_year), hoverinfo="text")%>% layout(title = "Yearwise trend of external countries involved in a conflict", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of countries involved'))

trend_yearwise_country_count
```

Clearly in 1991 [Gulf War] and 2003 [Invasion of Iraq] there are peaks. Many countries worldwide were involved in armed conflicts. There is a general upwards trend which indicates that countries are increasingly getting involved in wars as foreign powers trying to serve their own purpose.

Whenever an external power gets involved in an armed conflict, it might provide some of the many possible aids to the side it chooses to partner with. This might include:
Troop support, military support, allowing access to territory, providing weapons, material and logistics support amongst many other types of support.

**13. Yearwise trend of different countries involved as external supporters**


```{r}
columnsForCountryConflict <- c("conflictID","conflict_name","ywp_year","external_name","external_code","external_lat","external_long","external_code")
columnsForTypesOfSupport <- c("external_type_troops", "external_type_military","external_type_territory","external_type_weapon","external_type_material_log","external_type_training","external_type_economic","external_type_intelligence")

cummColumnsSupportType<- c(columnsForTypesOfSupport, columnsForCountryConflict)

df_Support_Types <- subset(externalHelp[cummColumnsSupportType],(external_lat != 'NA' & external_long != 'NA'))

groupByYearSupportTypes <- df_Support_Types %>% group_by(ywp_year)

aggregatedByYearSupportTypes <- aggregate(cbind(external_type_troops,external_type_military,external_type_territory,external_type_weapon,external_type_material_log,external_type_training,external_type_economic,external_type_intelligence) ~ ywp_year, df_Support_Types,FUN = sum)

## Plot line plots for each year...
trend_support_yearwise <- plot_ly(aggregatedByYearSupportTypes, x=~factor(ywp_year)) %>% add_trace(y=~external_type_troops, name = 'Troops', mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_military, name = "Military", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_territory, name = "Territory", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_weapon, name = "Weapon", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_material_log, name = "Material and Logistics", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_intelligence, name = "Intelligence", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_training, name = "Training", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_economic, name = "Funding", mode = 'lines+markers',type = 'scatter') %>% layout(title = "Different types of war support provided by external players ", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of countries'))

trend_support_yearwise
```

From the above line plot it can be clearly seen that the number of countries providing aid in terms of sending troops to fight in a foreign land on behalf of the warring party and training in a foreign country has seen a significant jump in 2004. This can be due to Invasion of Iraq in 2003 in which a number of NATO allied countries provided support.

There was a time of increased weapon, logistics and funding support in the years from 1977 to 1991 which coincides with the duration of Cold War. During this time, a number of proxy wars were fought throughout the world and hence increased external support.

**14. Which countries have provided different kinds of supports throughout the years under consideration?**


**1) Troops**

```{r}
getTextForSupport <- function(ext_name, countConflict){
  strToReturn <- paste("Country:", ext_name,"<br>Conflict count:",countConflict)
  return(strToReturn)
}

## Now determine which are the top 10 countries providing each type of support

aggregateByCountrySupportTypesOverall <- aggregate(cbind(external_type_troops,external_type_military,external_type_territory,external_type_weapon,external_type_material_log,external_type_training,external_type_economic,external_type_intelligence) ~ external_name+external_code, df_Support_Types,FUN = sum)

#1. Troops: Top 10 countries providing maximum troop support:
df_troop_country <- subset(aggregateByCountrySupportTypesOverall, select = c("external_name","external_type_troops","external_code"))
# Extract top 10 countries
descending_troop_country <-df_troop_country[with(df_troop_country, order(-df_troop_country$external_type_troops)),]
top10_troop_country <- descending_troop_country[1:10,]

map_troop_support <- plot_geo(top10_troop_country) %>%
  add_trace(
    z = ~external_type_troops,  locations = ~external_code,
    color = ~external_type_troops, color = ~external_code,colors = c("Blue","Red"), text = ~getTextForSupport(external_name, external_type_troops), hoverinfo = "text"
  ) %>%
  colorbar(title = "Conflict Count") %>%
  layout(
    title = 'Countries that provided highest Troop support in conflicts',
    geo = g_world
  )
map_troop_support
```

Russia has provided its troops in maximum number of conflicts worldwide from 1975 to 2009.

**2) Military support**

```{r}
#2. Military: Top 10 countries providing maximum military support:
df_military_country <- subset(aggregateByCountrySupportTypesOverall, select = c("external_name","external_type_military","external_code"))
# Extract top 10 countries
descending_military_country <-df_military_country[order(-df_military_country$external_type_military),]
top10_military_country <- descending_military_country[1:10,]

map_military_support <- plot_geo(top10_military_country) %>%
  add_trace(
    z = ~external_type_military,  locations = ~external_code,
    color = ~external_type_military, color = ~external_code,colors = c("Blue","Red"), text = ~getTextForSupport(external_name, external_type_military), hoverinfo = "text"
  ) %>%
  colorbar(title = "Conflict Count") %>%
  layout(
    title = 'Countries that provided highest Military support in conflicts',
    geo = g_world
  )
map_military_support
```

USA has provided its military support in maximum number of conflicts worldwide from 1975 to 2009.


**3) Territory**

```{r}
df_territory_country <- subset(aggregateByCountrySupportTypesOverall, select = c("external_name","external_type_territory","external_code"))
# Extract top 10 countries
descending_territory_country <-df_territory_country[order(-df_territory_country$external_type_territory),]
top10_territory_country <- descending_territory_country[1:10,]

map_territory_support <- plot_geo(top10_territory_country) %>%
  add_trace(
    z = ~external_type_territory,  locations = ~external_code,
    color = ~external_type_territory, color = ~external_code,colors = c("Blue","Red"), text = ~getTextForSupport(external_name, external_type_territory), hoverinfo = "text"
  ) %>%
  colorbar(title = "Conflict Count") %>%
  layout(
    title = 'Countries that provided highest Territory support in conflicts',
    geo = g_world
  )
map_territory_support
```
As expected the countries close to the ones that are involved in war can provide the maximum territorial support to the warring parties. From the map above, we can see the maximum support by Sudan.


**4) Weapons**

```{r}
df_weapon_country <- subset(aggregateByCountrySupportTypesOverall, select = c("external_name","external_type_weapon","external_code"))
# Extract top 10 countries
descending_weapon_country <-df_weapon_country[order(-df_weapon_country$external_type_weapon),]
top10_weapon_country <- descending_weapon_country[1:10,]

map_weapon_support <- plot_geo(top10_weapon_country) %>%
  add_trace(
    z = ~external_type_weapon,  locations = ~external_code,
    color = ~external_type_weapon, color = ~external_code,colors = c("Blue","Red"), text = ~getTextForSupport(external_name, external_type_weapon), hoverinfo = "text"
  ) %>%
  colorbar(title = "Conflict Count") %>%
  layout(
    title = 'Countries that provided highest Weapon support in conflicts',
    geo = g_world
  )
map_weapon_support
```

United States has been the largest supplier of weapons in conflict worldwide.


**5) Material/Logistics support**

```{r}
df_mat_log_country <- subset(aggregateByCountrySupportTypesOverall, select = c("external_name","external_type_material_log","external_code"))
# Extract top 10 countries
descending_mat_log_country <-df_mat_log_country[order(-df_mat_log_country$external_type_material_log),]
top10_mat_log_country <- descending_mat_log_country[1:10,]

map_mat_log_support <- plot_geo(top10_mat_log_country) %>%
  add_trace(
    z = ~external_type_material_log,  locations = ~external_code,
    color = ~external_type_material_log, color = ~external_code,colors = c("Blue","Red"), text = ~getTextForSupport(external_name, external_type_material_log), hoverinfo = "text"
  ) %>%
  colorbar(title = "Conflict Count") %>%
  layout(
    title = 'Countries that provided highest Material/Logistic support in conflicts',
    geo = g_world
  )
map_mat_log_support
```

Clearly USA has been the largest provider of Material and Logistic support in the conflicts worldwide.

**6) Intelligence**

```{r}
df_intelligence_country <- subset(aggregateByCountrySupportTypesOverall, select = c("external_name","external_type_intelligence","external_code"))
# Extract top 10 countries
descending_intelligence_country <-df_intelligence_country[order(-df_intelligence_country$external_type_intelligence),]
top10_intelligence_country <- descending_intelligence_country[1:10,]

map_intelligence_support <- plot_geo(top10_intelligence_country) %>%
  add_trace(
    z = ~external_type_intelligence,  locations = ~external_code,
    color = ~external_type_intelligence, color = ~external_code,colors = c("Blue","Red"), text = ~getTextForSupport(external_name, external_type_intelligence), hoverinfo = "text"
  ) %>%
  colorbar(title = "Conflict Count") %>%
  layout(
    title = 'Countries that provided highest Intelligence support in conflicts',
    geo = g_world
  )
map_intelligence_support
```

**7) Training support**

```{r}
df_training_country <- subset(aggregateByCountrySupportTypesOverall, select = c("external_name","external_type_training","external_code"))
descending_training_country <-df_training_country[order(-df_training_country$external_type_training),]
top10_training_country <- descending_training_country[1:10,]

map_training_support <- plot_geo(top10_training_country) %>%
  add_trace(
    z = ~external_type_training,  locations = ~external_code,
    color = ~external_type_training, color = ~external_code,colors = c("Blue","Red"), text = ~getTextForSupport(external_name, external_type_training), hoverinfo = "text"
  ) %>%
  colorbar(title = "Conflict Count") %>%
  layout(
    title = 'Countries that provided highest Training support in conflicts',
    geo = g_world
  )
map_training_support
```

**8) Funding/ Economic support**

```{r}
df_economic_country <- subset(aggregateByCountrySupportTypesOverall, select = c("external_name","external_type_economic","external_code"))
# Extract top 10 countries
descending_economic_country <-df_economic_country[order(-df_economic_country$external_type_economic),]
top10_economic_country <- descending_economic_country[1:10,]

map_economic_support <- plot_geo(top10_economic_country) %>%
  add_trace(
    z = ~external_type_economic,  locations = ~external_code,
    color = ~external_type_economic, color = ~external_code,colors = c("Blue","Red"), text = ~getTextForSupport(external_name, external_type_economic), hoverinfo = "text"
  ) %>%
  colorbar(title = "Conflict Count") %>%
  layout(
    title = 'Countries that provided highest Economic support in conflicts',
    geo = g_world
  )
map_economic_support
```


Let's see country wide distribution of supports.

1. USA

```{r}
aggregatedByYearAndCountrySupportTypes <- aggregate(cbind(external_type_troops,external_type_military,external_type_territory,external_type_weapon,external_type_material_log,external_type_training,external_type_economic,external_type_intelligence) ~ ywp_year+external_name+external_code, df_Support_Types,FUN = sum) # Extract corresponding support information.

#1.USA
subset_usa <- subset(aggregatedByYearAndCountrySupportTypes, external_code == 'USA')

trend_support_usa_yearwise <- plot_ly(subset_usa, x=~factor(ywp_year)) %>% add_trace(y=~external_type_troops, name = 'Troops', mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_military, name = "Military", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_territory, name = "Territory", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_weapon, name = "Weapon", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_material_log, name = "Material and Logistics", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_intelligence, name = "Intelligence", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_training, name = "Training", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_economic, name = "Funding", mode = 'lines+markers',type = 'scatter') %>% layout(title = "Different types of war support provided by USA ", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of conflicts where USA is involved'))

trend_support_usa_yearwise
```

As can be seen from the line plot above, USA provided extensive Weapon, Material and training support in various conflicts throughout the world. This further saw an increase in 2001 when US declared war on terror and invaded Iraq and Afghanistan.

2. Russia

```{r}
subset_russia <- subset(aggregatedByYearAndCountrySupportTypes, external_code == 'RUS')

trend_support_russia_yearwise <- plot_ly(subset_russia, x=~factor(ywp_year)) %>% add_trace(y=~external_type_troops, name = 'Troops', mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_military, name = "Military", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_territory, name = "Territory", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_weapon, name = "Weapon", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_material_log, name = "Material and Logistics", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_intelligence, name = "Intelligence", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_training, name = "Training", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_economic, name = "Funding", mode = 'lines+markers',type = 'scatter') %>% layout(title = "Different types of war support provided by Russia ", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of conflicts where Russia is involved'))
trend_support_russia_yearwise
```

Clearly Russia (Soviet Union) has increased involvement in conflicts throughout the world during the Cold War.

3. United Kingdom

```{r}
subset_uk <- subset(aggregatedByYearAndCountrySupportTypes, external_code == 'GBR')

trend_support_uk_yearwise <- plot_ly(subset_uk, x=~factor(ywp_year)) %>% add_trace(y=~external_type_troops, name = 'Troops', mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_military, name = "Military", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_territory, name = "Territory", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_weapon, name = "Weapon", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_material_log, name = "Material and Logistics", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_intelligence, name = "Intelligence", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_training, name = "Training", mode = 'lines+markers',type = 'scatter') %>% add_trace(y=~external_type_economic, name = "Funding", mode = 'lines+markers',type = 'scatter') %>% layout(title = "Different types of war support provided by UK ", xaxis = list(title = 'Year'), yaxis = list(title = 'Total number of conflicts where UK is involved'))
trend_support_uk_yearwise
```




# Analysis using Hypothesis Testing.

**1. H0: Duration of conflict is independent of number of external players present in a conflict.**

   **HA: Duration of conflict depends on number of external players involved.**

```{r}
columnsForCountryConflict <- c("conflictID","conflict_name","ywp_year","external_name","external_code","external_lat","external_long","external_code")
subsetWithConflictCountryCount <- externalHelp[columnsForCountryConflict] #4869

onlyCountrySupportConflictSubset <-  subset(subsetWithConflictCountryCount, (external_lat != 'NA' & external_long != 'NA')) #4135

countryCountDurationConflict <- onlyCountrySupportConflictSubset %>% group_by(conflictID,conflict_name) %>% mutate(unique_country_count_conflict =n_distinct(external_name), total_years_conflict = n_distinct(ywp_year))

extractSubsetConflictExternalYears <- subset(countryCountDurationConflict, select=c("conflictID", "conflict_name","unique_country_count_conflict","total_years_conflict"))

uniqueSubsetConflictExternalYears <- unique(extractSubsetConflictExternalYears)
```

Performing cursory analysis by plotting scatterplot.

```{r}
# Make a scatterplot between duration of conflict and number of external players involved.

plot_external_duration <- plot_ly(uniqueSubsetConflictExternalYears, x = ~unique_country_count_conflict, y = ~total_years_conflict, type = 'scatter', mode = 'lines+markers',text = ~paste('Conflict Name:',conflict_name,'<br>Conflict ID:',conflictID,'<br>Total external countries :',unique_country_count_conflict,'<br>Duration(years):',total_years_conflict), hoverinfo="text")%>% layout(title = "Number of external countries involved versus Duration of conflict", xaxis = list(title = 'Total unique countries'), yaxis = list(title = 'Total duration(years)'))

plot_external_duration
```

Scatterplot above does not give a clear understanding of whether the 2 variables are independent. Let's get rid of the datapoints in the above plot that are extreme i.e. points corresponding to conflicts 137, 62, 224, 176 and 226
Let's perform test of independence.

```{r}
uniqueSubsetConflictExternalYears <- subset(uniqueSubsetConflictExternalYears,  conflictID != 137 & conflictID != 62 & conflictID !=224 & conflictID !=176 & conflictID != 226)

mixCoords <- function(data) {
  n <- length(data$unique_country_count_conflict)
  stopifnot(n == length(data$total_years_conflict))
  new_x <- sample(data$unique_country_count_conflict, n, replace=FALSE)
  data.frame(unique_country_count_conflict=new_x, total_years_conflict=data$total_years_conflict)
}

smoothFitRobustOriginal <- loess(total_years_conflict ~ unique_country_count_conflict, data = uniqueSubsetConflictExternalYears, span=1, family="symmetric")

sd_original <- sd(smoothFitRobustOriginal$fitted) # 7.754087

stdDevList <- c()
for(i in 1:1000){
  shuffledDS <- mixCoords(uniqueSubsetConflictExternalYears)
  loessFitted <- loess(total_years_conflict ~ unique_country_count_conflict, data = shuffledDS, span=1, family="symmetric")
  sdev <- sd(loessFitted$fitted)
  stdDevList <- c(stdDevList,sdev)
}

# plot the histogram:
histogram_stdDev <-plot_ly(x = ~stdDevList, type = "histogram", hoverinfo = "none")%>%add_segments(x = sd_original, xend = sd_original, y = 0, yend = 140)%>%layout(title = "Histogram of standard deviation of shuffled dataset", xaxis = list(title = 'Standard deviation', range = c(0,10)), yaxis = list(title = 'Frequency'),showlegend = FALSE)

histogram_stdDev
```

It can clearly be seen from the graph that the probability of observing something as weird as the data is very very low under the null hypothesis. Hence, we have evidence against the null hypothesis that duration of conflict is independent of number of external players involved in the conflict.

**2. H0: Number of conflicts in the world is independendent of population of the world.**

   **HA: Number of conflicts is dependent on population of the world.**
   
```{r}
worldPopulationTotal <- read.csv(file = path_concat(dataDirectory, "TotalWorldPop.csv")) # in thousands.
popYears <- as.vector(t(worldPopulationTotal[1,]))
freqTableConflictYearWise$pop <- popYears

```

Let's plot a scatterplot to get a cursory idea.

```{r}
plot_pop_conflict <- plot_ly(freqTableConflictYearWise, x = ~pop, y = ~freq, type = 'scatter', mode = 'markers',text = ~paste('Year:',year,'<br>Conflict count:',freq,'<br>Population(in 1000s):',pop), hoverinfo="text")%>% layout(title = "Number of unique conflicts worldwide versus World population", xaxis = list(title = 'Population (in thousands)'), yaxis = list(title = 'Conflict frequency'))

plot_pop_conflict
```

Let's perform hypothesis testing.

```{r}
mixCoordsFreqPop <- function(data) {
  n <- length(data$pop)
  stopifnot(n == length(data$freq))
  new_x <- sample(data$pop, n, replace=FALSE)
  data.frame(pop=new_x, freq=data$freq)
}

smoothFitRobustOriginalFreqPop <- loess(freq ~ pop, data = freqTableConflictYearWise, span=1, family="symmetric")

sd_originalFreqPop <- sd(smoothFitRobustOriginalFreqPop$fitted) #3.247859

sdCount <- 0
stdDevListFreqPop <- c()
for(i in 1:1000){
  shuffledDS <- mixCoordsFreqPop(freqTableConflictYearWise)
  loessFitted <- loess(freq ~ pop, data = shuffledDS, span=1, family="symmetric")
  sdev <- sd(loessFitted$fitted)
  if(sdev>sd_originalFreqPop){
    sdCount<-sdCount+1
  }
  stdDevListFreqPop <- c(stdDevListFreqPop,sdev)
}

# plot the histogram:
histogram_stdDevFreqPop <-plot_ly(x = ~stdDevListFreqPop, type = "histogram", hoverinfo = "none")%>%add_segments(x = sd_originalFreqPop, xend = sd_originalFreqPop, y = 0, yend = 100)%>%layout(title = "Histogram of standard deviation of shuffled dataset", xaxis = list(title = 'Standard deviation', range = c(0,10)), yaxis = list(title = 'Frequency'),showlegend = FALSE)

histogram_stdDevFreqPop

```

It can clearly be seen from the above plot that under null hypothesis, we have high probablility of observing something we have observed in the data. Hence we do not have evidence against the null hypothesis that the number of conflicts is independent of population of the world over the years. (p-value = 0.253)


**3. H0: Number of unique state based conflicts is independent of population of the world.**

   **HA: Number of unique state based conflicts is dependent on population of the world.**

```{r}
#unique_region_year_type_df for a given year and violence type
total_year_violence <- aggregate(cbind(event_count) ~ year+type_of_violence, unique_region_year_type_df, FUN = sum)
total_state_based_year <- subset(total_year_violence, type_of_violence == 1)
total_state_based_year$pop <- popYears
```

Let's plot a scatterplot to get a cursory idea of relation.

```{r}
plot_pop_state_conflict <- plot_ly(total_state_based_year, x = ~pop, y = ~event_count, type = 'scatter', mode = 'markers',text = ~paste('Year:',year,'<br>State conflict count:',event_count,'<br>Population(in 1000s):',pop), hoverinfo="text")%>% layout(title = "Number of unique state based conflicts worldwide versus World population", xaxis = list(title = 'Population (in thousands)'), yaxis = list(title = 'State Conflict frequency'))

plot_pop_state_conflict
```

Clearly we can see a positive correlation between the two variables. Let's evaluate the correlation between the two.

```{r}
cor(total_state_based_year$event_count, total_state_based_year$pop)
```

The two variables are highly correlated with corr value of 0.909.

Let's perform hypothesis testing to determine the valididity of our hypothesis.

```{r}
mixCoordsStatePop <- function(data) {
  n <- length(data$pop)
  stopifnot(n == length(data$event_count))
  new_x <- sample(data$pop, n, replace=FALSE)
  data.frame(pop=new_x, event_count=data$event_count)
}

smoothFitRobustOriginalStatePop <- loess(event_count ~ pop, data = total_state_based_year, span=1, family="symmetric")

sd_originalStatePop <- sd(smoothFitRobustOriginalStatePop$fitted) #1231.224

sdCount <- 0
stdDevListStatePop <- c()
for(i in 1:1000){
  shuffledDS <- mixCoordsStatePop(total_state_based_year)
  loessFitted <- loess(event_count ~ pop, data = shuffledDS, span=1, family="symmetric")
  sdev <- sd(loessFitted$fitted)
  if(sdev>sd_originalStatePop){
    sdCount<-sdCount+1
  }
  stdDevListStatePop <- c(stdDevListStatePop,sdev)
}

# plot the histogram:
histogram_stdDevStatePop <-plot_ly(x = ~stdDevListStatePop, type = "histogram", hoverinfo = "none")%>%add_segments(x = sd_originalStatePop, xend = sd_originalStatePop, y = 0, yend = 120)%>%layout(title = "Histogram of standard deviation of shuffled dataset", xaxis = list(title = 'Standard deviation', range = c(0,1300)), yaxis = list(title = 'Frequency'),showlegend = FALSE)

histogram_stdDevStatePop
```

It can clearly be seen from the graph that the probability of observing something as weird as the data is very very low under the null hypothesis. Hence, we have evidence against the null hypothesis that number of state based conflicts is independent of population of the world.

**4. H0: Number of unique non-state based conflicts is independent of population of the world.**

   **HA: Number of unique non-state based conflicts is dependent on population of the world.**
   
```{r}
total_nonstate_based_year <- subset(total_year_violence, type_of_violence == 2)
total_nonstate_based_year$pop <- popYears
```

Let's plot a scatterplot to get a cursory idea of relation.

```{r}
plot_pop_nonstate_conflict <- plot_ly(total_nonstate_based_year, x = ~pop, y = ~event_count, type = 'scatter', mode = 'markers',text = ~paste('Year:',year,'<br>Non-State conflict count:',event_count,'<br>Population(in 1000s):',pop), hoverinfo="text")%>% layout(title = "Number of unique non-state based conflicts worldwide versus World population", xaxis = list(title = 'Population (in thousands)'), yaxis = list(title = 'Non-State Conflict frequency'))

plot_pop_nonstate_conflict
```


Let's perform hypothesis testing to determine the valididity of our hypothesis.

```{r}
mixCoordsNonStatePop <- function(data) {
  n <- length(data$pop)
  stopifnot(n == length(data$event_count))
  new_x <- sample(data$pop, n, replace=FALSE)
  data.frame(pop=new_x, event_count=data$event_count)
}

smoothFitRobustOriginalNonStatePop <- loess(event_count ~ pop, data = total_nonstate_based_year, span=1, family="symmetric")

sd_originalNonStatePop <- sd(smoothFitRobustOriginalNonStatePop$fitted) #157.8896

sdCount <- 0
stdDevListNonStatePop <- c()
for(i in 1:1000){
  shuffledDS <- mixCoordsNonStatePop(total_nonstate_based_year)
  loessFitted <- loess(event_count ~ pop, data = shuffledDS, span=1, family="symmetric")
  sdev <- sd(loessFitted$fitted)
  if(sdev>sd_originalStatePop){
    sdCount<-sdCount+1
  }
  stdDevListNonStatePop <- c(stdDevListNonStatePop,sdev)
}

# plot the histogram:
histogram_stdDevNonStatePop <-plot_ly(x = ~stdDevListNonStatePop, type = "histogram", hoverinfo = "none")%>%add_segments(x = sd_originalNonStatePop, xend = sd_originalNonStatePop, y = 0, yend = 120)%>%layout(title = "Histogram of standard deviation of shuffled dataset", xaxis = list(title = 'Standard deviation', range = c(0,200)), yaxis = list(title = 'Frequency'),showlegend = FALSE)

histogram_stdDevNonStatePop
```

It can clearly be seen from the graph that the probability of observing something as weird as the data is very very low under the null hypothesis. Hence, we have evidence against the null hypothesis that number of non state based conflicts is independent of population of the world.



**5. H0: Number of unique one-sided conflicts is independent of population of the world.**

   **HA: Number of unique one-sided conflicts is dependent on population of the world.**
  
```{r}
total_onesided_based_year <- subset(total_year_violence, type_of_violence == 3)
total_onesided_based_year$pop <- popYears
```

Let's plot a scatterplot to get a cursory idea of relation.

```{r}
plot_pop_onesided_conflict <- plot_ly(total_onesided_based_year, x = ~pop, y = ~event_count, type = 'scatter', mode = 'markers',text = ~paste('Year:',year,'<br>One sided conflict count:',event_count,'<br>Population(in 1000s):',pop), hoverinfo="text")%>% layout(title = "Number of unique one-sided conflicts worldwide versus World population", xaxis = list(title = 'Population (in thousands)'), yaxis = list(title = 'One sided Conflict frequency'))

plot_pop_onesided_conflict
```

Let's perform hypothesis testing to determine the valididity of our hypothesis.

```{r}
mixCoordsOneSidedPop <- function(data) {
  n <- length(data$pop)
  stopifnot(n == length(data$event_count))
  new_x <- sample(data$pop, n, replace=FALSE)
  data.frame(pop=new_x, event_count=data$event_count)
}

smoothFitRobustOriginalOneSidedPop <- loess(event_count ~ pop, data = total_onesided_based_year, span=1, family="symmetric")

sd_originalOneSidedPop <- sd(smoothFitRobustOriginalOneSidedPop$fitted) #157.8896

sdCount <- 0
stdDevListOneSidedPop <- c()
for(i in 1:1000){
  shuffledDS <- mixCoordsOneSidedPop(total_onesided_based_year)
  loessFitted <- loess(event_count ~ pop, data = shuffledDS, span=1, family="symmetric")
  sdev <- sd(loessFitted$fitted)
  if(sdev>sd_originalStatePop){
    sdCount<-sdCount+1
  }
  stdDevListOneSidedPop <- c(stdDevListOneSidedPop,sdev)
}

# plot the histogram:
histogram_stdDevOneSidedPop <-plot_ly(x = ~stdDevListOneSidedPop, type = "histogram", hoverinfo = "none")%>%add_segments(x = sd_originalOneSidedPop, xend = sd_originalOneSidedPop, y = 0, yend = 120)%>%layout(title = "Histogram of standard deviation of shuffled dataset", xaxis = list(title = 'Standard deviation', range = c(0,200)), yaxis = list(title = 'Frequency'),showlegend = FALSE)

histogram_stdDevOneSidedPop
```

It can clearly be seen from the graph that the probability of observing something as weird as the data is very very low under the null hypothesis. Hence, we have evidence against the null hypothesis that number of one-sided conflicts is independent of population of the world.

#Future scope

There are multiple things that can be further analyzed with the given database.

1. I have not used the information regarding the source of news given by 'source_article' column in ArmedConflict.csv. By analyzing the information, we can try to determine the bias that a given news source has in terms of presenting the news.

2. We can use the information regarding the precision of location where the attack has occured using columns 'where_prec' and 'where_coordinates' in ArmedConflict.csv to determine how often a specific region is attacked in an entire country. This can help us to identify the strongholds of organizations in the country of interest.



# Bibliography
1. https://en.wikipedia.org/wiki/Cold_War
2. http://www.un.org/esa/socdev/rwss/docs/2001/15%20Armed%20Conflict.pdf
3. http://www.lse.ac.uk/internationalDevelopment/research/crisisStates/download/drc/FailedState.pdf
4. http://ucdp.uu.se/downloads/ged/ged172.pdf
5. https://en.wikipedia.org/wiki/Operation_Juniper_Shield
6. https://en.wikipedia.org/wiki/2003_invasion_of_Iraq
7. https://en.wikipedia.org/wiki/Arab_Spring
8. https://sustainablesecurity.org/2017/09/27/targeting-civilians-in-civil-wars-why-ideology-matters/
9. http://blog.ucall.nl/index.php/2017/10/armed-non-state-actors-and-international-human-rights-law-an-analysis-of-the-un-security-council-and-un-general-assembly/
10. http://www.inegma.com/Admin/Content/File-81020131379.pdf
11. http://www.dw.com/en/why-is-northern-afghanistan-increasingly-unstable/a-37768779
12. http://www.dw.com/en/why-is-russia-so-interested-in-afghanistan-all-of-a-sudden/a-36989680
13. https://www.history.com/this-day-in-history/u-s-led-attack-on-afghanistan-begins
14. https://en.wikipedia.org/wiki/Colombian_conflict
15. https://en.wikipedia.org/wiki/Internal_conflict_in_Peru
16. http://www.documentarytube.com/articles/how-the-gulf-cartel-jurez-cartel-and-the-sinaloa-cartel-control-the-drug-trafficking-routes
17. https://en.wikipedia.org/wiki/First_Chechen_War
18. https://en.wikipedia.org/wiki/Second_Chechen_War
19. https://www.nytimes.com/2004/07/01/world/qatar-court-convicts-2-russians-in-top-chechen-s-death.html
20. https://en.wikipedia.org/wiki/Assassination_of_Zelimkhan_Yandarbiyev
21. https://en.wikipedia.org/wiki/Bosnian_War
22. https://en.wikipedia.org/wiki/Srebrenica_massacre
23. https://en.wikipedia.org/wiki/Gaza%E2%80%93Israel_conflict
24. https://en.wikipedia.org/wiki/Taliban_insurgency
25. https://www.cnn.com/2015/12/17/world/mapping-isis-attacks-around-the-world/index.html
26. https://www.vox.com/cards/things-about-isis-you-need-to-know/what-is-isis
27. http://www.newsweek.com/islamic-state-america-attacks-744497
28. https://en.wikipedia.org/wiki/September_11_attacks
29. https://en.wikipedia.org/wiki/Al-Qaeda_in_the_Islamic_Maghreb
30. https://en.wikipedia.org/wiki/Salafist_Group_for_Preaching_and_Combat
31. https://en.wikipedia.org/wiki/Lord%27s_Resistance_Army
32. https://simple.wikipedia.org/wiki/Cold_War
33. https://www.washingtonpost.com/archive/politics/1978/03/05/the-superpowers-and-the-ogaden-war/00f60ef2-01b4-4cd3-8c5f-e545df388def/?utm_term=457cfe09bd44
34. https://en.wikipedia.org/wiki/Soviet_Union_and_the_Iran%E2%80%93Iraq_War
35. https://en.wikipedia.org/wiki/International_aid_to_combatants_in_the_Iran%E2%80%93Iraq_War
36. https://www.history.com/topics/persian-gulf-war
37. http://www.mei.edu/content/article/iran-s-taliban-gamble-afghanistan
38. http://www.start.umd.edu/baad/narratives/northern-alliance-or-united-islamic-front-salvation-afghanistan-uifsa
39. https://www.hrw.org/reports/2001/afghan2/Afghan0701-02.htm
40. https://thediplomat.com/2017/09/whats-behind-saudi-arabias-turn-away-from-the-taliban/
41. https://www.aljazeera.com/indepth/features/2017/10/hamas-fatah-goal-approaches-171012064342008.html

# Extra information [Please read]

1. Please find attached all the data files used for analysis in the report. To run the project place the files in a folder and replace dataDirectory '/Users/hardiksahi/Second Term/Stat 847/Project/FinalDataSet847' with the location of your folder on line 61.
2. This report is submitted by:

**HARDIK SAHI**

**ID: 20743327**

**STAT-847**
